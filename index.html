<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Routine Check</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- SortableJS for drag-and-drop -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <!-- (Optional) Swiper.js for swipe navigation if implemented -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" /> -->
    <!-- <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script> -->
    <style>
        /* CSSã¯ç¾çŠ¶ã®checklist_daily2.htmlã®ã‚‚ã®ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€å¿…è¦ã«å¿œã˜ã¦æ‹¡å¼µãƒ»èª¿æ•´ */
        /* ãƒ˜ãƒ«ã‚¹ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—é–¢é€£ã®CSS (.health-tooltip-sectionãªã©) ã‚‚è¿½åŠ ãƒ»çµ±åˆã™ã‚‹ */
        /* å›ºå®šã‚¿ãƒ–ã¨ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã®è¦–è¦šçš„ãªåŒºåˆ¥ã‚’æ˜ç¢ºã«ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  */
        /* .company-day-badge ã®ç”»åƒè¡¨ç¤ºå¯¾å¿œ */
        :root {
            --primary-color: #007AFF;
            --bg-color: #F2F2F7;
            --card-bg: #FFFFFF;
            --text-main: #000000;
            --text-sub: #8E8E93;
            --danger: #FF3B30;
            --header-height: 120px;
            --footer-height: 80px;
            --light-pink: #FF99CC;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Sans", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* --- Header --- */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: rgba(242, 242, 247, 0.9);
            backdrop-filter: blur(10px);
            z-index: 100;
            padding-top: env(safe-area-inset-top);
            display: flex;
            flex-direction: column;
            border-bottom: 1px solid #ccc;
        }

        .header-top {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            position: relative;
        }

        .date-display {
            font-size: 1.248rem;
            font-weight: bold;
        }

        .month-display {
            font-size: 0.9rem;
            color: var(--text-sub);
            font-weight: normal;
        }

        .day-display {
            color: #FF69B4;
            /* Vivid pink */
            font-size: 2rem;
            /* Increased for better visibility */
        }

        .day-of-week-display {
            font-size: 2rem;
            /* Increased for better visibility */
            color: var(--text-main);
            /* Inherit main text color, or choose specific */
        }

        .company-day-badge {
            margin-left: 10px;
            /* background: #E60012; BN Red style */
            /* color: white; */
            font-size: 0.9rem;
            padding: 4px 8px;
            /* border-radius: 4px; */
            font-weight: bold;
            align-items: center;
            /* ç”»åƒã¨ãƒ†ã‚­ã‚¹ãƒˆã®å‚ç›´æ–¹å‘ã®ä½ç½®åˆã‚ã› */
            justify-content: center;
        }

        .company-day-badge img {
            height: 48px;
            /* BNãƒ­ã‚´ã®è¡¨ç¤ºã‚µã‚¤ã‚ºèª¿æ•´ */
            vertical-align: middle;
            margin-right: 5px;
        }


        .settings-btn {
            position: absolute;
            right: 15px;
            font-size: 1.2rem;
            color: var(--primary-color);
            cursor: pointer;
            display: flex;
            /* è¿½åŠ  */
            align-items: center;
            /* è¿½åŠ  */
            gap: 5px;
            /* è¿½åŠ  */
        }

        .mtg-button {
            position: absolute;
            right: 60px;
            /* Adjust this value to position it correctly relative to settings-btn */
            font-size: 1.4rem;
            color: var(--text-sub);
            /* Use primary color as a default */
            cursor: pointer;
            padding: 5px;
            /* Add some padding */
            display: flex;
            align-items: center;
        }

        #groupHeaderButtonArea {
            /* è¿½åŠ  */
            position: absolute;
            left: 15px;
            display: flex;
            align-items: center;
            height: 100%;
        }


        /* Marquee */
        .marquee-container {
            width: 100%;
            overflow: hidden;
            background: #fff;
            padding: 8px 0;
            border-top: 1px solid #e0e0e0;
            white-space: nowrap;
        }

        .marquee-text {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 15s linear infinite;
            font-size: 0.9rem;
            color: #333;
        }

        @keyframes marquee {
            0% {
                transform: translate(0, 0);
            }

            100% {
                transform: translate(-100%, 0);
            }
        }

        /* --- Main Content --- */
        main {
            margin-top: var(--header-height);
            margin-bottom: var(--footer-height);
            height: calc(100vh - var(--header-height) - var(--footer-height));
            overflow-y: auto;
            overflow-x: hidden;
            /* Added to prevent horizontal swiping */
            padding: 20px;
            -webkit-overflow-scrolling: touch;
        }

        /* --- Subgroups --- */
        .subgroup {
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
            position: relative;
            background-color: var(--card-bg);
            /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èƒŒæ™¯è‰²ã¯ç¶­æŒ */
            /* border-left ã¯å„ .color-X ã‚¯ãƒ©ã‚¹ã§è¨­å®š */
        }

        /* è‡ªå‹•é…è‰²ç”¨ã‚¯ãƒ©ã‚¹ã‚’æ·¡ã„è‰²åˆã„ã§å†è¨­å®šã—ã€å¯¾å¿œã™ã‚‹è‰²ã®ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ  */
        .color-0 {
            background-color: hsl(0, 30%, 95%);
            border-left: 5px solid hsl(0, 70%, 75%);
        }

        /* Reddish, faint bg, strong border */
        .color-1 {
            background-color: hsl(137.5, 30%, 95%);
            border-left: 5px solid hsl(137.5, 70%, 75%);
        }

        /* Greenish, faint bg, strong border */
        .color-2 {
            background-color: hsl(275, 30%, 95%);
            border-left: 5px solid hsl(275, 70%, 75%);
        }

        /* Purplish, faint bg, strong border */
        .color-3 {
            background-color: hsl(412.5, 30%, 95%);
            border-left: 5px solid hsl(412.5, 70%, 75%);
        }

        /* Yellowish-orange, faint bg, strong border */
        .color-4 {
            background-color: hsl(550, 30%, 95%);
            border-left: 5px solid hsl(550, 70%, 75%);
        }

        /* Bluish-green, faint bg, strong border */

        .subgroup-header {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #333;
            display: flex;
            align-items: center;
        }

        .subgroup-header i {
            margin-right: 8px;
        }

        /* --- Check Items --- */
        .check-item {
            background: rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s;
        }

        .check-left {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: background 0.2s;
            flex-shrink: 0;
        }

        .check-item.completed .checkbox {
            background: var(--primary-color);
        }

        .check-item.completed .item-title {
            text-decoration: line-through;
            color: var(--text-sub);
        }

        .check-item.completed {
            background: rgba(200, 200, 200, 0.2);
        }

        .action-btn {
            background: var(--primary-color);
            /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè‰² */
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 8px;
            text-decoration: none;
            display: inline-block;
            display: flex;
            /* è¿½åŠ  */
            align-items: center;
            /* è¿½åŠ  */
            justify-content: center;
            /* è¿½åŠ  */
            gap: 5px;
            /* è¿½åŠ  */
        }

        .action-btn img {
            height: 20px;
            /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³å†…ã®ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã‚µã‚¤ã‚º */
            width: auto;
            vertical-align: middle;
        }

        /* Icon-only button specific styles */
        .action-btn.icon-only-btn {
            background-color: white !important;
            /* èƒŒæ™¯ã‚’ç™½ã«å¼·åˆ¶ */
            border: none;
            padding: 0;
            box-shadow: none;
            /* Remove shadow if any */
            line-height: 1;
            /* Adjust line-height to fit image */
            min-width: unset;
            /* Remove min-width if present from action-button */
            margin-left: 8px;
            /* Ensure consistent spacing with other buttons */
            height: 36px;
            /* Explicitly set height for the button itself to match image */
            width: 36px;
            /* Explicitly set width for the button itself to match image */
            border-radius: 6px;
            /* Add some border-radius for aesthetics */
        }

        .action-btn.icon-only-btn img {
            height: 36px;
            /* Make image larger */
            width: 36px;
            /* Make image larger */
        }

        /* Shortcut specific color */
        .action-btn.shortcut {
            background: #FF9500;
        }

        /* URL specific color */
        .action-btn.url {
            background: #5856D6;
        }

        /* Mixed action buttons container */
        .action-btn-mixed {
            display: flex;
            gap: 5px;
            /* ãƒœã‚¿ãƒ³é–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
        }

        /* --- Footer Tabs --- */
        nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--footer-height);
            background: #fff;
            border-top: 1px solid #ccc;
            display: flex;
            justify-content: space-around;
            padding-bottom: env(safe-area-inset-bottom);
            z-index: 100;
        }

        .tab {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-sub);
            font-size: 0.7rem;
            cursor: pointer;
        }

        .tab i {
            font-size: 1.4rem;
            margin-bottom: 4px;
        }

        .tab.red-tab {
            color: var(--light-pink);
        }

        .tab.active {
            color: #FF007F;
        }

        /* å›ºå®šã‚¿ãƒ–ã®ç·¨é›†ä¸å¯æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .tab[data-editable="false"].editing {
            /* ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ™‚ã§ã‚‚ç·¨é›†ä¸å¯ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ */
            opacity: 0.6;
            cursor: default;
        }


        /* --- Editing Mode UI --- */
        .edit-controls {
            display: none;
            margin-left: auto;
        }

        body.editing .edit-controls {
            display: flex;
            gap: 8px;
            pointer-events: auto;
        }

        body.editing .edit-btn,
        body.editing .delete-btn {
            /* This rule is now effectively deprecated by the new button wrappers, but keeping for broader context */
            pointer-events: auto;
            opacity: 1;
            /* Ensure full visibility and clickability */
            cursor: pointer;
            /* Explicitly add cursor pointer for iOS touch events */
        }

        /* New styles for icon buttons wrapping Font Awesome icons */
        .edit-icon-btn,
        .delete-icon-btn {
            background: none;
            border: none;
            padding: 0;
            color: inherit;
            /* Inherit color from parent .edit-controls */
            font-size: 1.2rem;
            /* Match the icon size */
            cursor: pointer;
            pointer-events: auto;
            /* Ensure clickable */
            display: flex;
            /* Align icon */
            align-items: center;
            justify-content: center;
            width: 24px;
            /* Give a fixed size */
            height: 24px;
            /* Give a fixed size */
            margin: 0;
            /* Remove default button margin */
        }

        .delete-icon-btn {
            color: var(--danger);
            /* Apply danger color to delete button */
        }

        body.editing .edit-icon-btn,
        body.editing .delete-icon-btn {
            opacity: 1;
            /* Ensure full opacity in edit mode */
        }

        body.editing .checkbox,
        body.editing .action-btn {
            pointer-events: none;
            opacity: 0.3;
        }

        /* ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ã‚¯ãƒªãƒƒã‚¯ç„¡åŠ¹åŒ– */

        /* å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ç·¨é›†ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
        .group-content[data-editable="false"] .edit-controls {
            display: none !important;
        }

        /* å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ãƒ‰ãƒ©ãƒƒã‚°ãƒãƒ³ãƒ‰ãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
        .group-content[data-editable="false"] .drag-handle {
            display: none !important;
        }

        /* å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—å†…ã®è¿½åŠ ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
        .group-content[data-editable="false"] .add-item-area {
            display: none !important;
        }


        .delete-btn {
            color: var(--danger);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
        }

        .drag-handle {
            cursor: grab;
            color: #999;
            margin-right: 10px;
            display: none;
        }

        body.editing .drag-handle {
            display: block;
        }

        .add-item-area {
            display: none;
            text-align: center;
            padding: 10px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            margin-top: 10px;
            color: #888;
            cursor: pointer;
        }

        body.editing .add-item-area {
            display: block;
        }

        /* Modal (Simple Prompt Replacement for prototype) */
        /* ...Using native prompt for MVP... */

        /* Health Tooltip Styles (checklist_daily/index.htmlã‹ã‚‰çµ±åˆ) */
        .health-tooltip {
            position: fixed;
            /* Changed to fixed for better positioning with body overflow:hidden */
            background-color: rgba(40, 40, 40, 0.9);
            color: white;
            padding: 15px;
            border-radius: 12px;
            z-index: 1001;
            width: 80%;
            max-width: 300px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            /* Initially hidden */
            font-size: 14px;
            line-height: 1.6;
            left: 0;
            /* JSã§ä¸Šæ›¸ãã•ã‚Œã‚‹ */
            top: 0;
            /* JSã§ä¸Šæ›¸ãã•ã‚Œã‚‹ */
        }

        .health-tooltip-section {
            margin-bottom: 10px;
        }

        .health-tooltip-section:last-child {
            margin-bottom: 0;
        }

        .health-tooltip-section strong {
            color: #FFD700;
            /* Gold color for headers */
            display: block;
            margin-bottom: 5px;
            font-size: 15px;
        }

        .health-tooltip-section p {
            margin: 0;
        }

        .health-item {
            cursor: pointer;
        }

        .health-priority-header {
            font-size: 14px;
            font-weight: bold;
            color: #f39c12;
            /* Orange color */
            margin: 15px 0 5px 5px;
        }

        .category-header {
            /* checklist_daily/index.htmlã‹ã‚‰çµ±åˆ */
            font-size: 13px;
            font-weight: bold;
            color: #555;
            margin: 15px 0 8px 5px;
            border-bottom: 2px solid #a5d6a7;
            display: inline-block;
            padding-bottom: 2px;
        }

        /* ãƒ¢ãƒ¼ãƒ€ãƒ«å…±é€š (checklist_daily/index.htmlã‹ã‚‰çµ±åˆ) */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            width: 92%;
            max-width: 400px;
            padding: 20px;
            border-radius: 24px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 4px;
            color: #555;
        }

        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-size: 15px;
            box-sizing: border-box;
        }

        .time-row {
            display: flex;
            gap: 10px;
        }

        .time-row .form-group {
            flex: 1;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-cancel {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: none;
            background: #eee;
            font-weight: bold;
            font-size: 15px;
        }

        .btn-submit {
            width: 100%;
            padding: 18px;
            border-radius: 12px;
            border: none;
            background: #E91E63;
            color: white;
            font-weight: bold;
            font-size: 17px;
            cursor: pointer;
        }

        /* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ç­‰ã®å¤§å‹ãƒœã‚¿ãƒ³ */
        .reset-button {
            width: 100%;
            padding: 20px;
            background: #34c759;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 20px;
            margin-top: 10px;
            font-weight: bold;
            cursor: pointer;
        }

        .qr-button {
            background: #5856D6;
            margin-bottom: 20px;
            margin-top: 0;
        }
    </style>
</head>

<body>

    <div id="app">
        <header>
            <div class="header-top">
                <div id="dateDisplay" class="date-display"></div>
                <!-- BNãƒ­ã‚´ã¾ãŸã¯ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹imgã‚¿ã‚°ã«ç½®ãæ›ãˆ -->
                <div id="companyBadge" class="company-day-badge"></div>
                <span id="mtgButton" class="mtg-button" onclick="showMeetingsModal()"><i
                        class="fas fa-comments"></i></span>
                <div class="settings-btn" onclick="toggleEditMode()">
                    <i class="fas fa-cog"></i> <span id="editStatus" style="font-size:0.8rem"></span>
                </div>
                <!-- ã‚°ãƒ«ãƒ¼ãƒ—å›ºæœ‰ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãƒœã‚¿ãƒ³è¡¨ç¤ºã‚¨ãƒªã‚¢ (å¿…è¦ã«å¿œã˜ã¦) -->
                <div id="groupHeaderButtonArea"></div>
            </div>
            <div class="marquee-container">
                <div id="marqueeText" class="marquee-text"></div>
            </div>
        </header>

        <main id="mainContent">
            <!-- JavaScriptã«ã‚ˆã£ã¦ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«å‹•çš„ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
        </main>

        <nav id="tabBar">
            <!-- JavaScriptã«ã‚ˆã£ã¦ã‚¿ãƒ–ãŒã“ã“ã«å‹•çš„ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
        </nav>
    </div>

    <!-- ãƒ˜ãƒ«ã‚¹ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—è¦ç´  -->
    <div id="health-tooltip" class="health-tooltip"></div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ -->
    <div id="modalContainer">
        <!-- AIãŠã§ã‹ã‘ãƒ—ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ€ãƒ« (checklist_daily/index.htmlã‹ã‚‰çµ±åˆ) -->
        <div class="modal-overlay" id="aiModal">
            <div class="modal-content">
                <h2 style="text-align:center; font-size:18px; color:#8E44AD; margin-top:0;">âœ¨ AIãŠã§ã‹ã‘ãƒ—ãƒ©ãƒ³</h2>
                <div class="time-row">
                    <div class="form-group"><label>é–‹å§‹æ™‚é–“</label><input type="time" id="startTime" value="09:00"></div>
                    <div class="form-group"><label>çµ‚äº†æ™‚é–“</label><input type="time" id="endTime" value="17:00"></div>
                </div>
                <div class="form-group"><label>å ´æ‰€</label>
                    <select id="placeSelect">
                        <option value="åƒè‘‰å¸‚ç¾æµœåŒºã€èŠ±è¦‹åŒºå‘¨è¾ºï¼ˆå¹•å¼µå‘¨è¾ºï¼‰">å¹•å¼µå‘¨è¾º</option>
                        <option value="åƒè‘‰çœŒå†…">åƒè‘‰çœŒå†…</option>
                        <option value="æ±äº¬(å±±æ‰‹ç·šã‚ˆã‚Šæ±å´)">æ±äº¬(å±±æ‰‹ç·šã‚ˆã‚Šæ±å´)</option>
                        <option value="åŸ¼ç‰çœŒ">åŸ¼ç‰çœŒ</option>
                        <option value="ç¥å¥ˆå·çœŒ">ç¥å¥ˆå·çœŒ</option>
                        <option value="èŒ¨åŸçœŒ">èŒ¨åŸçœŒ</option>
                        <option value="é–¢æ±ç”²ä¿¡ã€æ±åŒ—ï¼ˆé æ–¹ï¼‰">é–¢æ±ç”²ä¿¡ãƒ»æ±åŒ—</option>
                    </select>
                </div>
                <div class="form-group"><label>ç§»å‹•æ‰‹æ®µ</label>
                    <select id="transportSelect">
                        <option value="è‡ªå‹•è»Š(ã‚«ãƒ¼ã‚·ã‚§ã‚¢)">è‡ªå‹•è»Š(ã‚«ãƒ¼ã‚·ã‚§ã‚¢)</option>
                        <option value="é›»è»Š">é›»è»Š</option>
                        <option value="è‡ªè»¢è»Š">è‡ªè»¢è»Š</option>
                        <option value="ãƒã‚¹">ãƒã‚¹</option>
                    </select>
                </div>
                <div class="time-row">
                    <div class="form-group"><label>æ–½è¨­æ•°</label>
                        <select id="facilityCount">
                            <option value="1ç®‡æ‰€">1ç®‡æ‰€</option>
                            <option value="2ç®‡æ‰€">2ç®‡æ‰€</option>
                            <option value="3ç®‡æ‰€">3ç®‡æ‰€</option>
                        </select>
                    </div>
                    <div class="form-group"><label>ãƒ—ãƒ©ãƒ³æ•°</label>
                        <select id="planCount">
                            <option value="1">1å€‹</option>
                            <option value="3">3å€‹</option>
                            <option value="5">5å€‹</option>
                            <option value="8">8å€‹</option>
                            <option value="10">10å€‹</option>
                            <option value="15" selected>15å€‹</option>
                        </select>
                    </div>
                </div>
                <div class="form-group"><label>ãƒ†ãƒ¼ãƒ</label>
                    <select id="envSelect">
                        <option value="å±‹å†…æ–½è¨­">å±‹å†…</option>
                        <option value="å±‹å¤–ï¼ˆå…¬åœ’ç­‰ï¼‰">å±‹å¤–</option>
                        <option value="ç¾è¡“é¤¨">ç¾è¡“é¤¨</option>
                        <option value="åšç‰©é¤¨">åšç‰©é¤¨</option>
                        <option value="å‹•ç‰©åœ’">å‹•ç‰©åœ’</option>
                        <option value="æ°´æ—é¤¨">æ°´æ—é¤¨</option>
                        <option value="ãƒ—ãƒ¼ãƒ«">ãƒ—ãƒ¼ãƒ«</option>
                    </select>
                </div>
                <div class="form-group"><label>å‚™è€ƒ</label><textarea id="freeText" rows="2"
                        placeholder="ã“ã ã‚ã‚Šã‚’å…¥åŠ›"></textarea></div>
                <div class="modal-buttons">
                    <button class="btn-submit" style="background:#8E44AD;"
                        onclick="submitAIPlan()">å®Ÿè¡Œ(Perplexity)</button>
                    <button class="btn-cancel" onclick="closeModal('aiModal')">æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- AIæ—…è¡Œè¨ˆç”»ãƒ¢ãƒ¼ãƒ€ãƒ« (checklist_daily/index.htmlã‹ã‚‰çµ±åˆ) -->
        <div class="modal-overlay" id="travelModal">
            <div class="modal-content">
                <h2 style="text-align:center; font-size:18px; color:#E91E63; margin-top:0;">âœˆï¸ AIæ—…è¡Œè¨ˆç”»</h2>
                <div class="form-group"><label>é€£ä¼‘å€™è£œï¼ˆ2026-2027ï¼‰</label>
                    <select id="trHoliday">
                        <option value="2æœˆ21æ—¥(åœŸ)ã€œ2æœˆ23æ—¥(æœˆãƒ»ç¥)ï¼š3é€£ä¼‘(å¤©çš‡èª•ç”Ÿæ—¥)">2/21-2/23 (3é€£ä¼‘)</option>
                        <option value="3æœˆ20æ—¥(é‡‘ãƒ»ç¥)ã€œ3æœˆ22æ—¥(æ—¥)ï¼š3é€£ä¼‘(æ˜¥åˆ†ã®æ—¥)">3/20-3/22 (3é€£ä¼‘)</option>
                        <option value="4æœˆ29æ—¥(æ°´ãƒ»ç¥)ã€œ5æœˆ6æ—¥(æ°´ãƒ»ç¥)ï¼š8é€£ä¼‘(GW)">4/29-5/6 (8é€£ä¼‘ãƒ»GW)</option>
                        <option value="7æœˆ18æ—¥(åœŸ)ã€œ7æœˆ20æ—¥(æœˆãƒ»ç¥)ï¼š3é€£ä¼‘(æµ·ã®æ—¥)">7/18-7æœˆ20æ—¥(æœˆãƒ»ç¥)ï¼š3é€£ä¼‘(æµ·ã®æ—¥)</option>
                        <option value="8æœˆ8æ—¥(åœŸ)ã€œ8æœˆ16æ—¥(æ—¥)ï¼š9é€£ä¼‘(ãŠç›†ä¼‘ã¿)">8/8-8/16 (9é€£ä¼‘ãƒ»ãŠç›†)</option>
                        <option value="9æœˆ19æ—¥(åœŸ)ã€œ9æœˆ23æ—¥(æ°´ãƒ»ç¥)ï¼š5é€£ä¼‘(ã‚·ãƒ«ãƒãƒ¼ã‚¦ã‚£ãƒ¼ã‚¯)">9/19-9æœˆ23æ—¥(æ°´ãƒ»ç¥)ï¼š5é€£ä¼‘(ã‚·ãƒ«ãƒãƒ¼ã‚¦ã‚£ãƒ¼ã‚¯)</option>
                        <option value="10æœˆ10æ—¥(åœŸ)ã€œ10æœˆ12æ—¥(æœˆãƒ»ç¥)ï¼š3é€£ä¼‘(ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥)">10/10-10/12 (3é€£ä¼‘)</option>
                        <option value="10æœˆ31æ—¥(åœŸ)ã€œ11æœˆ3æ—¥(ç«ãƒ»ç¥)ï¼š4é€£ä¼‘(æ–‡åŒ–ã®æ—¥)">10/31-11/3 (4é€£ä¼‘)</option>
                        <option value="11æœˆ21æ—¥(åœŸ)ã€œ11æœˆ23æ—¥(æœˆãƒ»ç¥)ï¼š3é€£ä¼‘(å‹¤åŠ´æ„Ÿè¬ã®æ—¥)">11/21-11/23 (3é€£ä¼‘)</option>
                        <option value="12æœˆ26æ—¥(åœŸ)ã€œ2027å¹´1æœˆ4æ—¥(æœˆ)ï¼š10é€£ä¼‘(å¹´æœ«å¹´å§‹)">12/26-1/4 (10é€£ä¼‘)</option>
                        <option value="2027å¹´1æœˆ9æ—¥(åœŸ)ã€œ1æœˆ11æ—¥(æœˆãƒ»ç¥)ï¼š3é€£ä¼‘(æˆäººã®æ—¥)">2027 1/9-1/11 (3é€£ä¼‘)</option>
                    </select>
                </div>
                <div class="time-row">
                    <div class="form-group"><label>ç›®çš„åœ°ã‚¨ãƒªã‚¢</label>
                        <select id="trPlace">
                            <option value="åŒ—æµ·é“">åŒ—æµ·é“</option>
                            <option value="æ±åŒ—">æ±åŒ—</option>
                            <option value="é–¢æ±ç”²ä¿¡è¶Š" selected>é–¢æ±ç”²ä¿¡è¶Š</option>
                            <option value="æ±æµ·ãƒ»åŒ—é™¸">æ±æµ·ãƒ»åŒ—é™¸</option>
                            <option value="è¿‘ç•¿">è¿‘ç•¿</option>
                            <option value="ä¸­å›½ãƒ»å››å›½">ä¸­å›½ãƒ»å››å›½</option>
                            <option value="ä¹å·ãƒ»æ²–ç¸„">ä¹å·ãƒ»æ²–ç¸„</option>
                        </select>
                    </div>
                    <div class="form-group"><label>å®¿æ³Šæ•°</label>
                        <select id="trStay">
                            <option value="ä¸€æ³ŠäºŒæ—¥">ä¸€æ³Š</option>
                            <option value="äºŒæ³Šä¸‰æ—¥" selected>äºŒæ³Š</option>
                            <option value="ä¸‰æ³Šå››æ—¥">ä¸‰æ³Š</option>
                            <option value="å››æ³Šäº”æ—¥">å››æ³Š</option>
                        </select>
                    </div>
                </div>
                <div class="form-group"><label>ä¸»ãªç§»å‹•æ‰‹æ®µ</label>
                    <select id="trTransport">
                        <option value="é£›è¡Œæ©Ÿ">é£›è¡Œæ©Ÿ</option>
                        <option value="æ–°å¹¹ç·š/ç‰¹æ€¥">æ–°å¹¹ç·š/ç‰¹æ€¥</option>
                        <option value="è‡ªå®¶ç”¨è»Š/ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼">è‡ªå‹•è»Š</option>
                        <option value="ãƒ•ã‚§ãƒªãƒ¼">ãƒ•ã‚§ãƒªãƒ¼</option>
                    </select>
                </div>
                <div class="time-row">
                    <div class="form-group"><label>1æ—¥ã®æ–½è¨­æ•°</label>
                        <select id="trFacility">
                            <option value="1ç®‡æ‰€">1ç®‡æ‰€</option>
                            <option value="2ç®‡æ‰€" selected>2ç®‡æ‰€</option>
                            <option value="3ç®‡æ‰€">3ç®‡æ‰€</option>
                        </select>
                    </div>
                    <div class="form-group"><label>ãƒ—ãƒ©ãƒ³æ•°</label>
                        <select id="trPlans">
                            <option value="1">1å€‹</option>
                            <option value="3" selected>3å€‹</option>
                            <option value="5">5å€‹</option>
                        </select>
                    </div>
                </div>
                <div class="form-group"><label>æ—…è¡Œãƒ†ãƒ¼ãƒ</label>
                    <select id="trEnv">
                        <option value="æ¸©æ³‰ãƒ»ãƒªãƒ©ãƒƒã‚¯ã‚¹">æ¸©æ³‰</option>
                        <option value="ãƒ†ãƒ¼ãƒãƒ‘ãƒ¼ã‚¯">ãƒ†ãƒ¼ãƒãƒ‘ãƒ¼ã‚¯</option>
                        <option value="è‡ªç„¶ãƒ»çµ¶æ™¯">è‡ªç„¶</option>
                        <option value="ã‚°ãƒ«ãƒ¡ãƒ»é£Ÿã¹æ­©ã">ã‚°ãƒ«ãƒ¡</option>
                        <option value="æ­´å²ãƒ»æ–‡åŒ–">æ­´å²</option>
                        <option value="ä½“é¨“å‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£">ä½“é¨“</option>
                    </select>
                </div>
                <div class="form-group"><label>ã“ã ã‚ã‚Šå‚™è€ƒ</label><textarea id="trFree" rows="2"
                        placeholder="äºˆç®—ã‚„å¤–ã›ãªã„å ´æ‰€ãªã©"></textarea></div>
                <div class="modal-buttons">
                    <button class="btn-submit" onclick="submitTravelPlan()">Perplexityã§æ—…è¡Œè¨ˆç”»ã‚’ä½œæˆ</button>
                    <button class="btn-cancel" onclick="closeModal('travelModal')">æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- é …ç›®è¿½åŠ ãƒ»ç·¨é›†ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« (ä»®å®Ÿè£…) -->
        <div class="modal-overlay" id="itemEditModal">
            <div class="modal-content">
                <h2 style="text-align:center; font-size:18px; color:var(--primary-color); margin-top:0;">é …ç›®ç·¨é›†</h2>
                <div class="form-group"><label>é …ç›®å</label><input type="text" id="editItemTitle"></div>
                <div class="form-group"><label>ã‚¢ã‚¤ã‚³ãƒ³ (çµµæ–‡å­— or IMGãƒ‘ã‚¹)</label><input type="text" id="editItemIcon"></div>
                <div class="form-group"><label>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—</label>
                    <select id="editItemActionType">
                        <option value="none">ãªã—</option>
                        <option value="shortcut">ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ</option>
                        <option value="url">URL</option>
                        <option value="modal">ãƒ¢ãƒ¼ãƒ€ãƒ«</option>
                        <option value="function">é–¢æ•°</option>
                    </select>
                </div>
                <div class="form-group" id="editItemActionValGroup"><label>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å€¤</label><input type="text"
                        id="editItemActionVal"></div>
                <div class="form-group" id="editItemActionLabelGroup"><label>ãƒœã‚¿ãƒ³ãƒ©ãƒ™ãƒ«</label><input type="text"
                        id="editItemActionLabel"></div>
                <div class="form-group" id="editItemActionIconGroup"><label>ãƒœã‚¿ãƒ³ã‚¢ã‚¤ã‚³ãƒ³ (IMGãƒ‘ã‚¹)</label><input type="text"
                        id="editItemActionIcon"></div>

                <div class="modal-buttons">
                    <button class="btn-submit" onclick="saveEditedItem()">ä¿å­˜</button>
                    <button class="btn-cancel" onclick="closeModal('itemEditModal')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                </div>
            </div><!-- modal-content end -->
        </div><!-- itemEditModal overlay end -->
        <!-- è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« -->
        <div class="modal-overlay" id="settingsModal">
            <div class="modal-content">
                <h2 style="text-align:center; font-size:18px; color:var(--primary-color); margin-top:0;">è¨­å®š</h2>

                <div class="form-group">
                    <label>å‡ºç¤¾æ—¥è¨­å®š</label>
                    <div id="companyDaysEdit" style="display:flex; justify-content:space-around; margin-top:10px;">
                        <!-- æ›œæ—¥ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒã“ã“ã«å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="form-group">
                    <label>ãƒ©ãƒ³ãƒ€ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¹ãƒˆ</label>
                    <textarea id="marqueeMessagesEdit" rows="5" style="width:100%;"></textarea>
                    <div style="display:flex; justify-content:flex-end; gap:5px; margin-top:5px;">
                        <button class="btn-cancel" style="width:auto; padding:5px 10px;"
                            onclick="addMarqueeMessage()">è¿½åŠ </button>
                        <button class="btn-cancel" style="width:auto; padding:5px 10px;"
                            onclick="removeMarqueeMessage()">å‰Šé™¤</button>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button class="btn-submit" onclick="saveSettings()">è¨­å®šã‚’ä¿å­˜</button>
                    <button class="btn-cancel" onclick="closeModal('settingsModal')">é–‰ã˜ã‚‹</button>
                </div>
            </div>
        </div>
        <!-- ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
        <div class="modal-overlay" id="meetingsModal">
            <div class="modal-content">
                <h2 style="text-align:center; font-size:18px; color:var(--primary-color); margin-top:0;">ä»Šæ—¥ã®MTG</h2>
                <div id="meetingsList" style="margin-top: 15px; font-size: 1rem; line-height: 1.6;">
                    <!-- Meeting details will be inserted here by JavaScript -->
                </div>
                <div class="modal-buttons">
                    <button class="btn-cancel" onclick="closeModal('meetingsModal')">é–‰ã˜ã‚‹</button>
                </div>
            </div>
        </div>
    </div><!-- modalContainer end -->

    <script>
        // --- Initial Data Structure (Default) ---
        // AppDataã®å‹å®šç¾©ï¼ˆTypeScripté¢¨ï¼‰
        // interface AppData {
        //     appSettings: {
        //         lastVisitDate: string; // YYYY-MM-DDå½¢å¼ã€‚æ—¥ã‚’è·¨ã„ã ãƒã‚§ãƒƒã‚¯ãƒªã‚»ãƒƒãƒˆç”¨ã€‚
        //         companyDays: number[]; // å‡ºç¤¾æ›œæ—¥ï¼ˆ0=æ—¥, 1=æœˆ, ..., 6=åœŸï¼‰ã€‚ä¾‹: [1, 2, 4]
        //         marqueeMessages: string[]; // ãƒãƒ¼ã‚­ãƒ¼è¡¨ç¤ºç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¹ãƒˆ
        //         companyLogoPath: string; // å‡ºç¤¾æ—¥ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ç”¨ã®ç”»åƒãƒ‘ã‚¹ (ä¾‹: "IMG/BN.png")ã€‚
        //     };
        //     groups: Group[]; // ã‚¿ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®é…åˆ—
        // }

        // interface Group {
        //     id: string; // ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€æ„è­˜åˆ¥å­ (ä¾‹: "g_daily", "g_other")
        //     title: string; // ã‚¿ãƒ–ã«è¡¨ç¤ºã•ã‚Œã‚‹åç§° (ä¾‹: "æ¯æ—¥", "ãã®ä»–")
        //     icon: string; // Font Awesomeã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒ©ã‚¹å (ä¾‹: "fa-clock", "fa-ellipsis-h")
        //     editable: boolean; // trueã®å ´åˆã€ã‚°ãƒ«ãƒ¼ãƒ—ã®ç·¨é›†ãƒ»å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆãŒå¯èƒ½ã€‚falseã®å ´åˆã€å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—ã§ã“ã‚Œã‚‰æ“ä½œã¯ä¸å¯ã€‚
        //     headerButton?: HeaderButton; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ãƒ˜ãƒƒãƒ€ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚°ãƒ«ãƒ¼ãƒ—å›ºæœ‰ã®ãƒœã‚¿ãƒ³
        //     subgroups: SubGroup[]; // ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®é…åˆ—
        // }

        // interface HeaderButton {
        //     id: string; // ãƒœã‚¿ãƒ³ã®ä¸€æ„è­˜åˆ¥å­ (ä¾‹: "btn_nursery_qr")
        //     title: string; // ãƒœã‚¿ãƒ³ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
        //     action: Action; // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š
        // }

        // interface SubGroup {
        //     id: string; // ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€æ„è­˜åˆ¥å­ (ä¾‹: "sg_daily_my_health")
        //     title: string; // ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¿ã‚¤ãƒˆãƒ«
        //     hidden?: boolean; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) trueã®å ´åˆã€ã“ã®ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã¯ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œãªã„ã€‚
        //     items: CheckItem[]; // ãƒã‚§ãƒƒã‚¯é …ç›®ã®é…åˆ—
        //     colorIndex: number; // é…è‰²ãƒ­ã‚¸ãƒƒã‚¯ã«åŸºã¥ãå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸè‰²ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (0-4)ã€‚
        // }

        // interface CheckItem {
        //     id: string; // ãƒã‚§ãƒƒã‚¯é …ç›®ã®ä¸€æ„è­˜åˆ¥å­ (ä¾‹: "fam_health_1")
        //     title: string; // ãƒã‚§ãƒƒã‚¯é …ç›®ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
        //     icon: string | null; // é …ç›®ã®æ¨ªã«è¡¨ç¤ºã•ã‚Œã‚‹çµµæ–‡å­—ã¾ãŸã¯ã‚¢ã‚¤ã‚³ãƒ³ãƒ‘ã‚¹ (ä¾‹: "ğŸ©¸", "IMG/custom_icon.png")
        //     isChecked: boolean; // ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹
        //     action: Action | null; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã®è¨­å®š
        //     healthTooltip?: HealthTooltip; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ãƒ˜ãƒ«ãƒ—ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã®å†…å®¹
        //     dynamic?: DynamicCondition; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) å‹•çš„è¡¨ç¤ºæ¡ä»¶ï¼ˆä¾‹: æ›œæ—¥ã«ã‚ˆã‚‹è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆï¼‰
        //     type?: "categoryHeader"; // (ç‰¹æ®Š) ã‚«ãƒ†ã‚´ãƒªãƒ˜ãƒƒãƒ€ãƒ¼ã®å ´åˆ
        // }

        // interface Action {
        //     label: string; // ãƒœã‚¿ãƒ³ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ©ãƒ™ãƒ« (ãƒ†ã‚­ã‚¹ãƒˆã€ã¾ãŸã¯ç”»åƒãƒ‘ã‚¹ã®å ´åˆIMG/xxx.pngãªã©)
        //     type: "shortcut" | "url" | "modal" | "function" | "mixed" | "image"; // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ç¨®é¡
        //     val: string | ActionMixedValue[] ; // ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆåã€URLã€ãƒ¢ãƒ¼ãƒ€ãƒ«IDã€é–¢æ•°åã€ã¾ãŸã¯mixedã®å ´åˆã®é…åˆ—
        //     icon?: string; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ãƒœã‚¿ãƒ³ã«è¡¨ç¤ºã™ã‚‹ç”»åƒã‚¢ã‚¤ã‚³ãƒ³ã®ãƒ‘ã‚¹
        // }

        // interface ActionMixedValue {
        //     type: "shortcut" | "url" ; // mixedã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ã‚¿ã‚¤ãƒ—
        //     label: string; // mixedã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ãƒœã‚¿ãƒ³ãƒ©ãƒ™ãƒ«
        //     val: string; // mixedã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆåã¾ãŸã¯URL
        //     icon?: string; // (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) mixedã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ãƒœã‚¿ãƒ³ç”»åƒã‚¢ã‚¤ã‚³ãƒ³ã®ãƒ‘ã‚¹
        // }

        // interface HealthTooltip {
        //     [key: `part${number}Title`]: string; // part1Title, part2Title, ...
        //     [key: `part${number}Text`]: string;   // part1Text, part2Text, ...
        // }

        // interface DynamicCondition {
        //     dayOfWeek?: number; // ç‰¹å®šã®æ›œæ—¥ (0=æ—¥, 1=æœˆ, ..., 6=åœŸ)
        //     weekNum?: number[]; // ç‰¹å®šã®é€±ç•ªå· (ä¾‹: [1, 3] = ç¬¬1, ç¬¬3é€±)
        // }


        const defaultData = {
            appSettings: {
                lastVisitDate: "",
                companyDays: [1, 2, 4], // Mon, Tue, Thu
                marqueeMessages: [
                    "äººç”Ÿã§å¤§åˆ‡ãªã®ã¯ã€å¯Œã®æœ€å¤§åŒ–ã§ã¯ãªãçµŒé¨“ã®æœ€å¤§åŒ–",
                    "å–œã³ã‚’å…ˆå»¶ã°ã—ã«ã—ãªã„ã§ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ã€Œä»Šã€",
                    "ã€Œã‚¼ãƒ­ã§æ­»ã¬ã€ã¨ã¯ã€å¿…è¦ä»¥ä¸Šã«ãŸã‚è¾¼ã¾ãšã€ä»Šã—ã‹ã§ããªã„çµŒé¨“ã«æ™‚é–“ã¨ãŠé‡‘ã‚’æŒ¯ã‚Šå‘ã‘ã‚‹ã¨ã„ã†æ„æ€æ±ºå®š",
                    "äººç”Ÿã®æœ€å¾Œã«æ®‹ã‚‹ã®ã¯æ€ã„å‡ºã§ã‚ã‚Šã€æ€ã„å‡ºã¯å¾Œã‹ã‚‰ã‚‚â€œé…å½“â€ã‚’ä¸ãˆã‚‹",
                    "ãŠé‡‘ã¯ã€Œãƒ©ã‚¤ãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ã¨ã—ã¦æ‰ãˆã‚‹ã¨ã€ä½¿ã„æ–¹ã®ç²¾åº¦ãŒä¸ŠãŒã‚‹",
                    "æœ€å¼·ã®æŠ•è³‡å…ˆã¯çµŒé¨“ã§ã‚ã‚Šã€çµŒé¨“ã¯â€œè¨˜æ†¶ã®é…å½“â€ã¨ã—ã¦äººç”Ÿã‚’è±Šã‹ã«ã—ç¶šã‘ã‚‹",
                    "ã€Œãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«é ¼ã‚‰ãšã€ç¢ºå®Ÿã«ã§ãã‚‹è¡Œå‹•ã‚’è¨­å®šã™ã‚‹ã€",
                    "æ€’ã‚Šã¯å¦å®šã§ã‚‚æˆ‘æ…¢ã§ã‚‚ãªãã€ã€Œã‚ã‚‹ã€ã¨ç†è§£ã™ã‚‹",
                    "ä¼ãˆã‚‹ãªã‚‰ã€Œäº‹å®Ÿãƒ»æ„Ÿæƒ…ãƒ»å¸Œæœ›ã€ã§æ•´ãˆã‚‹",
                    "æœ«å°¾ã«ã€Œâ€¦ã¨æ€ã£ãŸã ã‘ã€ã‚’ä»˜ã‘ã¦ã¿ã‚‹ï¼ˆå¦„æƒ³ã®è­˜åˆ¥ï¼‰"
                ],
                companyLogoPath: "IMG/BN.png",
                meetingSchedule: {
                    0: [], // Sunday
                    1: ["è‡ªç¤¾å®šä¾‹"], // Monday
                    2: ["ï¼“ç¤¾å…¨ä½“å®šä¾‹", "å…ˆæ–¹ã™ã‚Šåˆã‚ã›", "è‡ªç¤¾PJãƒªãƒ¼ãƒ€ãƒ¼å®šä¾‹"], // Tuesday
                    3: [], // Wednesday
                    4: ["DmFXå®šä¾‹"], // Thursday
                    5: ["ï¼“ç¤¾FXå®šä¾‹"], // Friday
                    6: []  // Saturday
                }
            },
            groups: [
                // g_daily (æ¯æ—¥)
                {
                    id: "g_daily",
                    title: "æ¯æ—¥",
                    icon: "fa-clock", // FontAwesome icon
                    editable: false, // å›ºå®šã‚¿ãƒ–
                    subgroups: [
                        {
                            id: "sg_daily_my_health",
                            title: "ğŸ‘¨ è‡ªåˆ†ï¼š50ä»£ã®å¥åº·æˆ¦ç•¥",
                            items: [
                                { id: "fam_health_1", title: "1. è¡€ç³–å€¤ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆé£Ÿã¹ã™ããªã„ã€è¾›ã„ã‚‚ã®æ§ãˆã‚‹ï¼‰", icon: "ğŸ©¸", isChecked: false, action: null, healthTooltip: { part1Title: "ç³–å°¿ç—…ãƒ»èªçŸ¥ç—‡ãƒ»ç™Œãƒªã‚¹ã‚¯ã«ç›´çµã€‚è¡€ç®¡è€åŒ–ã‚’é˜²ãæœ€å„ªå…ˆäº‹é …ã€‚", part1Text: "ãƒ™ã‚¸ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆï¼ˆé‡èœã‹ã‚‰ï¼‰ã€ç³–è³ªã®éå‰°æ‘‚å–é˜²æ­¢ã€‚" } },
                                { id: "fam_health_2", title: "2. è¡€åœ§ã¨è¡€ç®¡ï¼ˆäºœéº»ä»æ²¹ï¼‰", icon: "ğŸ’“", isChecked: false, action: null, healthTooltip: { part1Title: "è„³æ¢—å¡ã‚„å¿ƒç­‹æ¢—å¡ã®å¼•ãé‡‘ã€‚50ä»£ã¯ã“ã®ãƒªã‚¹ã‚¯ãŒæ€¥ä¸Šæ˜‡ã—ã¾ã™ã€‚", part1Text: "æ¸›å¡©ã¨ã€è¡€ç®¡ã‚’æŸ”ã‚‰ã‹ãä¿ã¤è‰¯è³ªãªæ²¹ï¼ˆã‚ªãƒ¡ã‚¬3ãªã©ï¼‰ã®æ‘‚å–ã€‚" } },
                                { id: "fam_health_3", title: "3. ç­‹è‚‰é‡ï¼ˆéšæ®µã‚’ç™»ã‚‹ï¼‰", icon: "ğŸ’ª", isChecked: false, action: null, healthTooltip: { part1Title: "ä»£è¬ã‚’ç¶­æŒã—ã€å°†æ¥ã®å¯ãŸãã‚Šã‚’é˜²ããŸã‚ã€‚", part1Text: "ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®æ‘‚å–ï¼ˆæ¯é£Ÿï¼‰ã¨ã€é€±2ã€œ3å›ã®è‡ªé‡ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€‚" } },
                                { id: "fam_health_4", title: "4. ç¡çœ ã®è³ªãƒ»è„³å›å¾©", icon: "ğŸ’¤", isChecked: false, action: null, healthTooltip: { part1Title: "è„³ã®è€å»ƒç‰©ã‚’æƒé™¤ã—ã€è‡ªå¾‹ç¥çµŒã‚’æ•´ãˆã‚‹å”¯ä¸€ã®æ™‚é–“ã ã‹ã‚‰ã€‚", part1Text: "å¯ã‚‹å‰ã®ã‚¹ãƒãƒ›æ–­ã¡ã€æ±ºã¾ã£ãŸæ™‚é–“ã®èµ·åºŠã€‚" } },
                                { id: "fam_health_5", title: "5. ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ»å­¤ç‹¬å›é¿", icon: "ğŸ§˜", isChecked: false, action: null, healthTooltip: { part1Title: "æ…¢æ€§çš„ãªã‚¹ãƒˆãƒ¬ã‚¹ã¯å…ç–«åŠ›ã‚’ä¸‹ã’ã€ä¸‡ç—…ã®å…ƒã«ãªã‚‹ãŸã‚ã€‚", part1Text: "ã€Œä½•ã‚‚ã—ãªã„æ™‚é–“ã€ã‚’æ„å›³çš„ã«ä½œã‚‹ã€è¶£å‘³ã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚’æŒã¤ã€‚" } }
                            ],
                            colorIndex: 0 // ä»®ã®è‰²ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                        },
                        {
                            id: "sg_daily_mind",
                            title: "ğŸ’¡ å¿ƒãŒã‘",
                            items: [
                                { id: "d3", title: "Die With Zero", icon: "ğŸ’°", isChecked: false, action: { label: "Die With Zero", type: "shortcut", val: "Die With Zero" } },
                                { id: "d4", title: "AI100æœ¬ãƒãƒƒã‚¯", icon: "ğŸ¤–", isChecked: false, action: { label: "PDF", type: "url", val: "https://fullswing.dena.com/pdf/AI_100tips_slide.pdf" } },
                                { id: "d_humor", title: "ãƒ¦ãƒ¼ãƒ¢ã‚¢ãƒ»ã„ãŸãšã‚‰å¿ƒã‚’æŒã¤ï¼ˆãŸã ã—ã‚„ã‚Šéããªã„ï¼‰", icon: "ğŸ˜‚", isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_daily_irritated",
                            title: "ğŸ’¢ ã‚¤ãƒ©ã‚¤ãƒ©ã—ãŸã‚‰",
                            items: [
                                { id: "d_irritated", title: "æŠ‘è‚æ•£åŠ é™³çš®åŠå¤", icon: "ğŸ’Š", isChecked: false, action: { label: "æ¼¢æ–¹", type: "url", val: "https://www.kracie.co.jp/ph/k-therapy/product/symptom/menopause/frustration.html#:~:text=%E3%81%AA%E3%81%A3%E3%81%A6%E3%81%8D%E3%81%9F-,%E3%81%8A%E3%81%99%E3%81%99%E3%82%81%E3%81%AE%E6%BC%A2%E6%96%B9%E5%87%A6%E6%B3%A2,-%E6%8A%91%E8%82%9D%E6%95%A3" } },
                                { id: "d_biofermin", title: "ãƒ“ã‚ªãƒ•ã‚§ãƒ«ãƒŸãƒ³", icon: "ğŸ’Š", isChecked: false, action: null },
                                { id: "d2", title: "æ€’ã‚‹æŠ€æ³•", icon: "ğŸ“–", isChecked: false, action: { label: "æ€’ã‚‹æŠ€æ³•", type: "shortcut", val: "æ€’ã‚‹æŠ€æ³•" } }
                            ],
                            colorIndex: 1
                        },
                        {
                            id: "sg_daily_childcare",
                            title: "ğŸ‘¶ è‚²å…",
                            items: [
                                { id: "d1", title: "ãŠã™ã—ã•ã„ã“ã†ã‹ã‚ˆ", icon: "ğŸ£", isChecked: false, action: { label: "ãŠã™ã—", type: "url", val: "https://tk.ismcdn.jp/mwimgs/4/3/375w/img_437bd1ff6f61737861b410cae52b0346356004.jpg" } },
                                { id: "d_non_cognitive", title: "éèªçŸ¥æ©Ÿèƒ½", icon: "ğŸŒŸ", isChecked: false, action: null, healthTooltip: { part1Title: "ã€ŒéŠã³ã€ã‚’è¨­è¨ˆã™ã‚‹", part1Text: "å¹¼å…æœŸã®å­¦ã³ã®ä¸­å¿ƒã¯è‡ªç™ºçš„ãƒ»èƒ½å‹•çš„ãªã€ŒéŠã³ã€ã§ã€éŠã³ã‚’é€šã—ã¦ã€Œã‚„ã£ã¦ã¿ãŸã„â†’ç²˜ã‚Šå¼·ãâ†’å·¥å¤«ã™ã‚‹ã€ãŒèµ·ãã‚„ã™ã„ã¨è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚[2] å®¶ã§ã¯ã€é›£æ˜“åº¦ãŒå°‘ã—ã ã‘é«˜ã„éŠã³ï¼ˆä¾‹ï¼šç©ã¿æœ¨ã§â€œå€’ã‚Œãªã„æ©‹â€ã€ãŠæ‰‹ä¼ã„ã§â€œæœ€å¾Œã¾ã§é‹ã¶â€ãªã©ï¼‰ã‚’ç”¨æ„ã—ã€é€”ä¸­ã§è©°ã¾ã£ãŸã‚‰ç­”ãˆã‚’è¨€ã†ã‚ˆã‚Šã€Œã©ã†ã—ãŸã‚‰è‰¯ã•ãã†ï¼Ÿã€ã¨è©¦è¡ŒéŒ¯èª¤ã‚’ä¿ƒã™ã®ãŒç‹™ã„ã«åˆã„ã¾ã™ã€‚[2]", part2Title: "å…·ä½“çš„ãªâ€œæ¯æ—¥â€ã®ã—ã‹ã‘ï¼ˆçŸ­ãï¼‰", part2Text: "- é¸ã¹ã‚‹ç›®æ¨™ã‚’ä½œã‚‹ï¼šã€Œã©ã£ã¡ã«ã™ã‚‹ï¼Ÿã€ã§è‡ªåˆ†ã§æ±ºã‚ã‚‹æ©Ÿä¼šã‚’å¢—ã‚„ã™ï¼ˆç›®æ¨™ã¸ã®ä¸»ä½“æ€§ï¼‰ã€‚[2]- ãƒ—ãƒ­ã‚»ã‚¹ã‚’è¨€èªåŒ–ã—ã¦è¤’ã‚ã‚‹ï¼šã€Œå·¥å¤«ã—ãŸã­ã€ã€Œç¶šã‘ãŸã­ã€ã€Œå‹ã ã¡ã‚’å¾…ã¦ãŸã­ã€ï¼ˆçµæœã‚ˆã‚Šå–ã‚Šçµ„ã¿ï¼‰ã€‚[1][2]- å°ã•ãªå½¹å‰²ã‚’ä»»ã›ã‚‹ï¼šå®¶åº­å†…ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆé…è†³ã€ç‰‡ä»˜ã‘ã€æ¤ç‰©ã®æ°´ã‚„ã‚Šï¼‰ã§ç¶™ç¶šãƒ»èª¿æ•´ãƒ»å”åŠ›ã‚’åŒæ™‚ã«ä½¿ã†ã€‚[2]", part3Title: "è¦ªã®ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‚‚åœŸå°", part3Text: "OECDã®æ•´ç†ã§ã¯ã€è¦ªã®æƒ…ç·’çŠ¶æ…‹ï¼ˆãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹ç­‰ï¼‰ã‚„å®¶åº­ã®ã‚¹ãƒˆãƒ¬ã‚¹ã¯ã€å­ã©ã‚‚ã®ç¤¾ä¼šæƒ…å‹•çš„ç™ºé”ã«å½±éŸ¿ã—ã†ã‚‹è¦å› ã¨ã—ã¦æ‰±ã‚ã‚Œã¦ã„ã¾ã™ã€‚[1] ã€Œå­ã©ã‚‚ã®ãŸã‚ã«å®Œç’§ã«ã‚„ã‚‹ã€ã‚ˆã‚Šã€è¦ªãŒç„¡ç†ã‚’æ¸›ã‚‰ã—ã¦å®‰å®šã—ãŸå¿œç­”ï¼ˆè½ã¡ç€ã„ã¦åå¿œã§ãã‚‹çŠ¶æ…‹ï¼‰ã‚’ä½œã‚‹ã“ã‚Œè‡ªä½“ãŒã€å›ã‚Šé“ã«è¦‹ãˆã¦å®Ÿã¯åŠ¹æœçš„ã§ã™ã€‚[1]" } },
                                { id: "d_child_teeth_hard", title: "æ­¯ã‚’ä¸ˆå¤«ã«ãƒ»ç¡¬ã„é£Ÿã¹ç‰©ã‚’å™›ã‚€", icon: "ğŸ¦·", isChecked: false, action: null },
                                { id: "d_child_sugar_reduce", title: "ç”˜ã„ç‰©ã‚’æ‘‚ã‚‹æ©Ÿä¼šã‚’æ¸›ã‚‰ã™", icon: "ğŸ¬", isChecked: false, action: null }
                            ],
                            colorIndex: 2
                        },
                        {
                            id: "sg_daily_routine",
                            title: "ğŸ”„ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³",
                            items: [
                                { id: "d5", title: "å¤©æ°—ç¢ºèª", icon: "ğŸŒ¤ï¸", isChecked: false, action: { label: "", type: "mixed", val: [{ type: "shortcut", label: "WeatherNews", val: "WeatherNews", icon: "IMG/weathernewspng.png" }, { type: "shortcut", label: "Yå¤©æ°—", val: "Yå¤©æ°—", icon: "IMG/Ytenki.png" }] } },
                                { id: "d6", title: "æ´—æ¿¯æ©Ÿã‚’å›ã™", icon: "ğŸ§º", isChecked: false, action: { label: "ãŠæ´—æ¿¯æƒ…å ±", type: "url", val: "https://weathernews.jp/s/laundry/area/chiba/12101/", icon: "IMG/sentaku.jpeg" } },
                                { id: "d7", title: "ãƒ†ãƒ¬ãƒ“ä½“æ“", icon: "ğŸ“º", isChecked: false, action: { label: "", type: "mixed", val: [{ type: "shortcut", label: "NHK one", val: "NHK one", icon: "IMG/nhk.png" }, { type: "shortcut", label: "Streaks", val: "Streaks", icon: "IMG/str.webp" }] } },
                                { id: "d_flaxseed", title: "ã‚¢ãƒãƒ‹æ²¹ã‚’æ‘‚å–", icon: null, isChecked: false, action: null },
                                { id: "d_seieshi_ai", title: "ç”ŸæˆAIã‚’ä½¿ã†", icon: null, isChecked: false, action: { label: "", type: "mixed", val: [{ type: "shortcut", label: "Gemini", val: "Gemini", icon: "IMG/gemini2.png" }, { type: "shortcut", label: "NotebookLM", val: "NotebookLM", icon: "IMG/notebooklm.png" }, { type: "shortcut", label: "Perplexity", val: "Perplexity", icon: "IMG/Per.png" }, { type: "shortcut", label: "ChatGPT", val: "ChatGPT", icon: "IMG/CGPT.webp" }] } },
                                { id: "d8", title: "âœ“ ã‚¿ã‚¹ã‚¯", icon: null, isChecked: false, action: { label: "TickTick", type: "shortcut", val: "ticktick", icon: "https://img.icons8.com/color/512/tick-tick.png" } },
                                { id: "d_obsidian", title: "Obsidian", icon: "âœï¸", isChecked: false, action: { label: "", type: "mixed", val: [{ type: "shortcut", label: "Daily Note", val: "Obsidian Daily" }, { type: "shortcut", label: "Obsidian", val: "Obsidian", icon: "IMG/unnamed.webp" }] } },
                                { id: "d9", title: "ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼", icon: "ğŸ“…", isChecked: false, action: { label: "", type: "mixed", val: [{ type: "shortcut", label: "Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼", val: "Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼", icon: "https://upload.wikimedia.org/wikipedia/commons/a/a5/Google_Calendar_icon_%282020%29.svg" }, { type: "shortcut", label: "TimeTree", val: "TimeTree", icon: "IMG/tt.png" }] } },
                                { id: "d_gmail", title: "Gmail", icon: "ğŸ“§", isChecked: false, action: { label: "Gmail", type: "shortcut", val: "Gmail", icon: "IMG/gmai.png" } },
                                { id: "d_codmon", title: "ã‚³ãƒ‰ãƒ¢ãƒ³", icon: "ğŸ“±", isChecked: false, action: { label: "ã‚³ãƒ‰ãƒ¢ãƒ³", type: "shortcut", val: "ã‚³ãƒ‰ãƒ¢ãƒ³", icon: "IMG/cdmn.png" } },
                                { id: "d_eos", title: "EOS R8", icon: "ğŸ“·", isChecked: false, action: { label: "Camera Connect", type: "shortcut", val: "Camera Connect", icon: "IMG/cc.webp" } },
                                { id: "d_diary", title: "æ—¥è¨˜", icon: "ğŸ“”", isChecked: false, action: { label: "ã‚¸ãƒ£ãƒ¼ãƒŠãƒ«", type: "shortcut", val: "ã‚¸ãƒ£ãƒ¼ãƒŠãƒ«", icon: "IMG/j.png" } },
                                { id: "d_photos", title: "iPhoneå†™çœŸ/å‹•ç”»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—", icon: "ğŸ“±", isChecked: false, action: { label: "Photos", type: "shortcut", val: "photos mobile", icon: "IMG/pht.png" } }
                            ],
                            colorIndex: 2
                        },
                        {
                            id: "sg_daily_housework",
                            title: "ğŸ§¹ å®¶äº‹",
                            items: [
                                { id: "d_towel", title: "æ´—é¢æ‰€ã®ã‚¿ã‚ªãƒ«äº¤æ›", icon: "ğŸ§´", isChecked: false, action: null },
                                { id: "d10", title: "çª“ã®çµéœ²æ‹­ã", icon: "ğŸªŸ", isChecked: false, action: null },
                                { id: "d12", title: "ãŠé¢¨å‘‚æ´—ã„ç¢ºèª", icon: "ğŸ›", isChecked: false, action: { label: "LINEé€£çµ¡", type: "shortcut", val: "ãŠé¢¨å‘‚æƒé™¤æ¸ˆã¿" } },
                                { id: "d13", title: "åŠ æ¹¿å™¨ã®æ°´", icon: "ğŸ’§", isChecked: false, action: null },
                                { id: "d14", title: "ã‚´ãƒŸæ¨ã¦", icon: "ğŸ—‘ï¸", isChecked: false, action: null },
                                { id: "d_petbottle", title: "ãƒšãƒƒãƒˆãƒœãƒˆãƒ«", icon: "ğŸ¥¤", isChecked: false, action: null },
                                { id: "d_nonburnable", title: "ä¸ç‡ƒã”ã¿", icon: "ğŸ”¥", isChecked: false, action: null },
                                { id: "d_can", title: "ç¼¶", icon: "ğŸ¥«", isChecked: false, action: null },
                                { id: "d_bottle", title: "ãƒ“ãƒ³", icon: "ğŸ¾", isChecked: false, action: null },
                                { id: "d_tue", title: "ãƒ€ãƒ³ãƒœãƒ¼ãƒ«å‡ºã— (ç¬¬1ãƒ»3ç«æ›œ)", icon: "ğŸ“¦", isChecked: false, action: null, dynamic: { dayOfWeek: 2, weekNum: [1, 3] } }
                            ],
                            colorIndex: 3
                        },
                        {
                            id: "sg_daily_outing",
                            title: "ğŸš— ãŠå‡ºã‹ã‘",
                            items: [
                                { id: "d15", title: "ã‚«ãƒ¼ã‚·ã‚§ã‚¢ç¢ºèª", icon: "ğŸš—", isChecked: false, action: { label: "ä¸‰äº•ã®ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒ¼ã‚º", type: "shortcut", val: "ä¸‰äº•ã®ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒ¼ã‚º", icon: "IMG/carshare.webp" } },
                                { id: "d16", title: "ãŠå‡ºã‹ã‘æƒ…å ±", icon: "ğŸ¡", isChecked: false, action: { label: "", type: "mixed", val: [{ type: "shortcut", label: "ã‚¢ã‚½ãƒ“ãƒ¥ãƒ¼", val: "ã‚¢ã‚½ãƒ“ãƒ¥ãƒ¼", icon: "IMG/aso.png" }, { type: "url", label: "ã„ã“ãƒ¼ã‚ˆ", val: "https://iko-yo.net/", icon: "IMG/ikoyo.webp" }, { type: "url", label: "Rank", val: "https://www.jalan.net/ranking/" }] } },
                                { id: "d_ai_outing", title: "AIãŠã§ã‹ã‘ãƒ—ãƒ©ãƒ³ææ¡ˆ", icon: "âœ¨", isChecked: false, action: { label: "AIå®Ÿè¡Œ", type: "modal", val: "aiModal" } }
                            ],
                            colorIndex: 3
                        },
                        {
                            id: "sg_daily_travel_plan",
                            title: "âœˆï¸ æ—…è¡Œè¨ˆç”»",
                            items: [
                                { id: "d_ai_travel", title: "AIæ—…è¡Œãƒ—ãƒ©ãƒ³ãƒ»æ—¥ç¨‹ææ¡ˆ", icon: "âœˆï¸", isChecked: false, action: { label: "æ—…è¡Œè¨ˆç”»", type: "modal", val: "travelModal" } },
                                { id: "d17", title: "ãƒˆãƒ©ãƒ™ãƒ«", icon: "ğŸ¨", isChecked: false, action: { label: "æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«", type: "shortcut", val: "æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«", icon: "IMG/raku_T.png" } }
                            ],
                            colorIndex: 3
                        }
                    ]
                },
                // g_holiday (ä¼‘æ—¥)
                {
                    id: "g_holiday",
                    title: "ä¼‘æ—¥",
                    icon: "fa-campground", // FontAwesome icon
                    editable: false, // å›ºå®šã‚¿ãƒ–
                    subgroups: [
                        {
                            id: "sg_holiday_todo",
                            title: "ã‚„ã‚‹äº‹",
                            items: [
                                { id: "ho_wash", title: "æ´—æ¿¯æ©Ÿã‚’å›ã™", icon: "ğŸ§º", isChecked: false, action: null },
                                { id: "ho_dish", title: "é£Ÿæ´—æ©Ÿã®é£Ÿå™¨ã‚’ã—ã¾ã†", icon: "ğŸ½ï¸", isChecked: false, action: null },
                                { id: "ho_laundry_top", title: "æ´—æ¿¯ç‰©ã‚’å¹²ã™", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "ho7", title: "ç¥–çˆ¶æ¯é›»è©±", icon: "ğŸ“º", isChecked: false, action: { label: "Alexa", type: "shortcut", val: "Alexa" } }
                            ],
                            colorIndex: 4
                        },
                        {
                            id: "sg_holiday_organize",
                            title: "ğŸ§¹ æ•´ç†",
                            items: [
                                { id: "ho_org_clothes", title: "æ´‹æœã®æ•´ç†", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "ho_org_desk", title: "PCã®æœºã®ä¸Šã®æ•´ç†", icon: "ğŸ–¥ï¸", isChecked: false, action: null },
                                { id: "ho_org_bulky_waste", title: "ç²—å¤§ã”ã¿æ‰‹ç¶šã", icon: "ğŸ—‘ï¸", isChecked: false, action: null }
                            ],
                            colorIndex: 4
                        },
                        {
                            id: "sg_holiday_organize_method",
                            title: "ğŸ’¡ æ•´ç†æ–¹æ³• (ã‚¿ãƒƒãƒ—ã§è©³ç´°)",
                            items: [
                                { id: "ho_org_seiri", title: "1. æ•´ç† (Seiriï¼šè¦ã‚‹/è¦ã‚‰ãªã„)", icon: null, isChecked: false, action: null, healthTooltip: { part1Title: "ç›®çš„ã¯ã€Œä¸è¦ç‰©ã‚’é™¤ãã€ã“ã¨ã§ã™ã€‚", part1Text: "æ‰‹é †ï¼ˆæœº1å°ãƒ»15åˆ†ç›®å®‰ï¼‰ï¼šã‚´ãƒŸè¢‹ã‚’ç”¨æ„ã—ã€æ˜ã‚‰ã‹ãªã‚´ãƒŸã‚’å³æ¨ã¦ã€‚æœºã®ä¸Šã®ç‰©ã‚’å…¨éƒ¨ã©ã‘ã¦ã€4åˆ†é¡ï¼ˆæ¯æ—¥ä½¿ã†/æ™‚ã€…ä½¿ã†/åˆ¥ã®éƒ¨å±‹/æ¨ã¦ãƒ»ä¿ç•™ï¼‰ã®ä»®ç½®ãã‚’ä½œã‚‹ã€‚ã€Œä¿ç•™ã€ã¯ç®±ã«ã¾ã¨ã‚ã¦æœŸé™ã‚’æ±ºã‚ã¦å†åˆ¤å®šã€‚" } },
                                { id: "ho_org_seiton", title: "2. æ•´é “ (Seitonï¼šå®šä½ç½®ãƒ»å–ã‚Šã‚„ã™ã•)", icon: null, isChecked: false, action: null, healthTooltip: { part1Title: "ç›®çš„ã¯ã€Œå¿…è¦å“ã‚’ä½¿ã„ã‚„ã™ã„é…ç½®ã«ã™ã‚‹ã€ã“ã¨ã§ã™ã€‚", part1Text: "æœºå‘ã‘ã®æ±ºã‚æ–¹ï¼ˆ10ã€œ20åˆ†ï¼‰ï¼šâ€œæ¯æ—¥ä½¿ã†ç‰©ã ã‘â€ã‚’æœºä¸Šã«æˆ»ã™ã€‚ç½®ãå ´æ‰€ãƒ»ç½®ãæ–¹ã‚’ãƒ«ãƒ¼ãƒ«åŒ–ï¼ˆã‚ˆãä½¿ã†ç‰©ã»ã©æ‰‹å‰/åˆ©ãæ‰‹å´ï¼‰ã€‚å°ç‰©ã¯ã€Œ1ãƒˆãƒ¬ãƒ¼/1ãƒãƒ¼ãƒã€ã«é›†ç´„ã€‚" } },
                                { id: "ho_org_seiso", title: "3. æ¸…æƒ (Seisoï¼šæƒé™¤ï¼‹ç‚¹æ¤œ)", icon: null, isChecked: false, action: null, healthTooltip: { part1Title: "ç›®çš„ã¯ã€Œãã‚Œã„ã«ã—ã¦ã€ç•°å¸¸ã«ã‚‚æ°—ã¥ã‘ã‚‹çŠ¶æ…‹ã«ã™ã‚‹ã€ã“ã¨ã§ã™ã€‚", part1Text: "å¤©æ¿â†’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å‘¨è¾ºâ†’ãƒ¢ãƒ‹ã‚¿ãƒ¼ä¸‹ã®é †ã«æ‹­ãï¼ˆç‰©ã‚’æˆ»ã™å‰ãŒæœ€é€Ÿï¼‰ã€‚æ±šã‚ŒãŒå‡ºã‚‹å ´æ‰€ï¼æ•£ã‚‰ã‹ã‚‹åŸå› ã«ãªã‚Šã‚„ã™ã„å ´æ‰€ãªã®ã§ã€æ¬¡ã®é…ç½®æ”¹å–„ã®ãƒ’ãƒ³ãƒˆã«ã™ã‚‹ã€‚" } },
                                { id: "ho_org_seiketsu", title: "4. æ¸…æ½” (Seiketsuï¼šæ¨™æº–åŒ–)", icon: null, isChecked: false, action: null, healthTooltip: { part1Title: "ç›®çš„ã¯ã€æ•´ç†ã€œæ¸…æƒã‚’ã€Œã„ã¤ã§ã‚‚å†ç¾ã§ãã‚‹å½¢ã€ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚", part1Text: "â€œå®Œæˆå½¢â€ã®å†™çœŸã‚’1æšæ’®ã£ã¦ã€æœºã®åŸºæº–ã«ã™ã‚‹ã€‚ãƒ©ãƒ™ãƒ«ãƒ»å®šä½ç½®ã‚’æ±ºã‚ã€èª°ãŒè¦‹ã¦ã‚‚æˆ»ã›ã‚‹çŠ¶æ…‹ã«ã™ã‚‹ã€‚" } },
                                { id: "ho_org_shitsuke", title: "5. ã—ã¤ã‘ (Shitsukeï¼šç¿’æ…£åŒ–)", icon: null, isChecked: false, action: null, healthTooltip: { part1Title: "ç›®çš„ã¯ã€æ±ºã‚ãŸåŸºæº–ã‚’å®ˆã‚‹è¡Œå‹•ã‚’ç¿’æ…£ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚", part1Text: "1æ—¥1å›ã€çµ‚æ¥­æ™‚ã«ã€Œæœºä¸Šï¼å…¥åŠ›æ©Ÿå™¨ï¼‹ãƒˆãƒ¬ãƒ¼1å€‹ã€ã¾ã§æˆ»ã™é‹ç”¨ã«ã™ã‚‹ã€‚é€±1å›ã®ç°¡æ˜“ãƒã‚§ãƒƒã‚¯ï¼ˆ5åˆ†ï¼‰ã§ã€åŸºæº–ã‹ã‚‰ã‚ºãƒ¬ãŸç‰©ã ã‘æˆ»ã™ã‚ˆã†ã«ã™ã‚‹ã€‚" } }
                            ],
                            colorIndex: 4
                        },
                        {
                            id: "sg_holiday_ai_outing",
                            title: "âœ¨ AIãŠã§ã‹ã‘è¨ˆç”»",
                            items: [
                                { id: "ho0", title: "AIãŠã§ã‹ã‘ãƒ—ãƒ©ãƒ³ææ¡ˆ", icon: "âœ¨", isChecked: false, action: { label: "AIå®Ÿè¡Œ", type: "modal", val: "aiModal" } }
                            ],
                            hidden: true,
                            colorIndex: 1
                        },
                        {
                            id: "sg_holiday_ai_travel",
                            title: "âœˆï¸ AIæ—…è¡Œè¨ˆç”»",
                            items: [
                                { id: "ho_travel", title: "AIæ—…è¡Œãƒ—ãƒ©ãƒ³ãƒ»æ—¥ç¨‹ææ¡ˆ", icon: "âœˆï¸", isChecked: false, action: { label: "æ—…è¡Œè¨ˆç”»", type: "modal", val: "travelModal" } }
                            ],
                            hidden: true,
                            colorIndex: 3
                        },
                        {
                            id: "sg_holiday_my_prep",
                            title: "è‡ªåˆ†ã®æº–å‚™",
                            items: [
                                { id: "ho1", title: "ç€æ›¿ãˆ", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "ho2", title: "Watchè£…ç€", icon: "âŒšï¸", isChecked: false, action: null },
                                { id: "ho3", title: "éµã‚’ã¤ã‘ã‚‹", icon: "ğŸ”‘", isChecked: false, action: null },
                                { id: "ho4", title: "ã‚«ãƒãƒ³æº–å‚™", icon: "ğŸ’", isChecked: false, action: null },
                                { id: "ho5", title: "ãƒãƒƒãƒ†ãƒªãƒ¼", icon: "ğŸ”‹", isChecked: false, action: null },
                                { id: "ho6", title: "ã‚±ãƒ¼ãƒ–ãƒ«", icon: "ğŸ”Œ", isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_holiday_car_share",
                            title: "ã‚«ãƒ¼ã‚·ã‚§ã‚¢",
                            items: [
                                { id: "ho8", title: "ã‚«ãƒ¼ã‚·ã‚§ã‚¢", icon: "ğŸš—", isChecked: false, action: { label: "CS", type: "shortcut", val: "ä¸‰äº•ã®ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒ¼ã‚º" } },
                                { id: "ho9", title: "ã‚¸ãƒ¥ãƒ‹ã‚¢ã‚·ãƒ¼ãƒˆ", icon: "ğŸ‘¶", isChecked: false, action: null },
                                { id: "ho10", title: "é…”ã„æ­¢ã‚", icon: "ğŸ¤¢", isChecked: false, action: null },
                                { id: "ho11", title: "ETCã‚«ãƒ¼ãƒ‰", icon: "ğŸš—", isChecked: false, action: null },
                                { id: "ho12", title: "çœ¼é¡/ã‚µãƒ³ã‚°ãƒ©ã‚¹", icon: null, isChecked: false, action: null },
                                { id: "ho13", title: "ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼", icon: "ğŸ›’", isChecked: false, action: null },
                                { id: "ho14", title: "ã‚¬ãƒ ", icon: "ğŸ¬", isChecked: false, action: null }
                            ],
                            colorIndex: 3
                        },
                        {
                            id: "sg_holiday_outing_luggage",
                            title: "ãŠã§ã‹ã‘è·ç‰©",
                            items: [
                                { id: "ho15", title: "ã‚ªãƒ ãƒ„", icon: "ğŸ©·", isChecked: false, action: null },
                                { id: "ho16", title: "iPad", icon: "ğŸ“±", isChecked: false, action: null },
                                { id: "ho17", title: "é™¤èŒã‚·ãƒ¼ãƒˆ", icon: "ğŸ§»", isChecked: false, action: null },
                                { id: "ho18", title: "ãƒªãƒ¥ãƒƒã‚¯/ã‚¬ãƒ©ã‚¬ãƒ©", icon: "ğŸ’", isChecked: false, action: null },
                                { id: "ho_bottle", title: "ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ãƒœãƒˆãƒ«(é£²ã¿ç‰©)", icon: "ğŸ¼", isChecked: false, action: null },
                                { id: "ho19", title: "ãƒ†ã‚£ãƒƒã‚·ãƒ¥", icon: "ğŸ§»", isChecked: false, action: null },
                                { id: "ho20", title: "ç€æ›¿ãˆ", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "ho21", title: "ãƒãƒ³ã‚«ãƒ", icon: "ğŸ§¼", isChecked: false, action: null }
                            ],
                            colorIndex: 1
                        },
                        {
                            id: "sg_holiday_outing_prep2",
                            title: "ãŠå‡ºã‹ã‘æº–å‚™ï¼’",
                            items: [
                                { type: "categoryHeader", title: "ğŸ“· ã‚«ãƒ¡ãƒ©" },
                                { id: "ho_cam_eos", title: "EOS R8", icon: "ğŸ“·", isChecked: false, action: null },
                                { id: "ho_cam_lens", title: "ãƒ¬ãƒ³ã‚º", icon: null, isChecked: false, action: null },
                                { id: "ho_cam_battery", title: "ãƒãƒƒãƒ†ãƒªãƒ¼", icon: "ğŸ”‹", isChecked: false, action: null },
                                { id: "ho_cam_tripod", title: "ä¸‰è„š", icon: null, isChecked: false, action: null },
                                { id: "ho_cam_mobile_tripod", title: "æºå¸¯ã‚«ãƒ¡ãƒ©ä¸‰è„š", icon: null, isChecked: false, action: null },
                                { type: "categoryHeader", title: "ğŸ•ï¸ ãƒ‡ã‚¤ã‚­ãƒ£ãƒ³ãƒ—" },
                                { id: "ho_dc_tent", title: "ãƒ†ãƒ³ãƒˆ", icon: null, isChecked: false, action: null },
                                { id: "ho_dc_groundsheet", title: "ã‚°ãƒ©ãƒ³ãƒ‰ã‚·ãƒ¼ãƒˆ", icon: null, isChecked: false, action: null },
                                { id: "ho_dc_chair", title: "æ¤…å­", icon: null, isChecked: false, action: null },
                                { id: "ho_dc_table", title: "ãƒ†ãƒ¼ãƒ–ãƒ«", icon: null, isChecked: false, action: null }
                            ],
                            colorIndex: 0 // Using colorIndex 0 for now, similar to 'è‡ªåˆ†ã®æº–å‚™'
                        },
                        {
                            id: "sg_holiday_transport",
                            title: "äº¤é€šæ©Ÿé–¢",
                            items: [
                                { id: "ho22", title: "ãƒã‚¹", icon: "ğŸšŒ", isChecked: false, action: { label: "", type: "mixed", val: [{ type: "url", label: "SP", val: "https://heiwakotsu.com/timefare_baytown/19time_baytown.pdf" }, { type: "url", label: "ãƒãƒªãƒ³", val: "https://heiwakotsu.com/timefare_baytown/baytown00_3.pdf" }] } },
                                { id: "ho23", title: "é›»è»Šï¼šæµ·æµœå¹•å¼µé§…", icon: "ğŸšƒ", isChecked: false, action: { label: "æ™‚åˆ»è¡¨", type: "url", val: "https://transit.yahoo.co.jp/timetable/22226/950" } }
                            ],
                            colorIndex: 2
                        },
                        {
                            id: "sg_holiday_meals",
                            title: "ğŸ½ï¸ é£Ÿäº‹",
                            items: [
                                { id: "ho_okano", title: "cafe okano", icon: "â˜•ï¸", isChecked: false, action: { label: "X", type: "url", val: "https://x.com/cafeokano?s=21&t=EjJBVaQXUmSoBZe-IjkvnA" } }
                            ],
                            colorIndex: 4
                        },
                        {
                            id: "sg_holiday_housework_pm",
                            title: "å®¶äº‹(åˆå¾Œ)",
                            items: [
                                { id: "ho_h8", title: "æ´—æ¿¯ç‰©ã®å–ã‚Šè¾¼ã¿", icon: "ğŸ§º", isChecked: false, action: null },
                                { id: "ho_h9", title: "æ´—æ¿¯ç‰©ç•³ã¿", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "ho_h10", title: "ãƒ‘ã‚¸ãƒ£ãƒæº–å‚™", icon: "ğŸŒ™", isChecked: false, action: null },
                                { id: "ho_h11", title: "ã‚ªãƒ ãƒ„è£œå……", icon: "ğŸ©·", isChecked: false, action: null },
                                { id: "ho_window_close", title: "çª“é–‰ã‚", icon: "ğŸªŸ", isChecked: false, action: null },
                                { id: "ho_h12", title: "è¿½ã„ç„šã", icon: "ğŸ”¥", isChecked: false, action: null },
                                { id: "ho_wash_reserve", title: "é¢¨å‘‚å¾Œã«ç¿Œæ—¥ã®æ´—æ¿¯æ©Ÿäºˆç´„", icon: null, isChecked: false, action: { label: "æ™‚é–“", type: "function", val: "calcHours" } }
                            ],
                            colorIndex: 1
                        },
                        {
                            id: "sg_holiday_grooming",
                            title: "èº«ã ã—ãªã¿",
                            items: [
                                { id: "ho_groom_nails", title: "çˆªåˆ‡ã‚Š", icon: "ğŸ’…", isChecked: false, action: null },
                                { id: "ho_groom_ears", title: "è€³æƒé™¤", icon: "ğŸ‘‚", isChecked: false, action: null },
                                { id: "ho_groom_sideburns", title: "ã‚‚ã¿ã‚ã’", icon: "âœ‚ï¸", isChecked: false, action: null },
                                { id: "ho_groom_nose", title: "é¼»ã®æ‰‹å…¥ã‚Œ", icon: "ğŸ‘ƒ", isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        }
                    ]
                },
                // g_work (å‡ºç¤¾)
                {
                    id: "g_work",
                    title: "å‡ºç¤¾",
                    icon: "fa-building", // FontAwesome icon
                    editable: false, // å›ºå®šã‚¿ãƒ–
                    subgroups: [
                        {
                            id: "sg_work_prep",
                            title: "å‡ºç¤¾æº–å‚™",
                            items: [
                                { id: "w1", title: "é«­å‰ƒã‚Š", icon: "ğŸª’", isChecked: false, action: null },
                                { id: "w2", title: "ç€æ›¿ãˆ", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "w3", title: "ãƒˆã‚¤ãƒ¬", icon: "ğŸš½", isChecked: false, action: null },
                                { id: "w4", title: "Watchè£…ç€", icon: "âŒšï¸", isChecked: false, action: null },
                                { id: "w5", title: "éµã‚’ã¤ã‘ã‚‹", icon: "ğŸ”‘", isChecked: false, action: null },
                                { id: "w6", title: "é«ªã®æ¯›ã‚»ãƒƒãƒˆ", icon: "ğŸ‘±", isChecked: false, action: null },
                                { id: "w8", title: "ã‚«ãƒãƒ³æº–å‚™", icon: "ğŸ’", isChecked: false, action: null },
                                { id: "w9", title: "ç©ºã®æ°´ç­’ã‚’å…¥ã‚Œã‚‹", icon: "ğŸš°", isChecked: false, action: null },
                                { id: "w10", title: "ãƒã‚¹ã‚¯", icon: "ğŸ˜·", isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_work_money_prep",
                            title: "é€€å‹¤æº–å‚™",
                            items: [
                                { id: "w_money_kintai", title: "å‹¤æ€ é€£çµ¡", icon: null, isChecked: false, action: null },
                                { id: "w_leave_calc", title: "é€€å‹¤æ™‚é–“ç®—å‡º", icon: "â°", isChecked: false, action: { label: "ç®—å‡º", type: "function", val: "calcLeaveTime" } }
                            ],
                            colorIndex: 1
                        }
                    ]
                },
                // g_home (åœ¨å®…)
                {
                    id: "g_home",
                    title: "åœ¨å®…",
                    icon: "fa-home", // FontAwesome icon
                    editable: false, // å›ºå®šã‚¿ãƒ–
                    subgroups: [
                        {
                            id: "sg_home_prep",
                            title: "è‡ªåˆ†ã®æº–å‚™",
                            items: [
                                { id: "h_prep_change", title: "ç€æ›¿ãˆ", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "h_prep_watch", title: "Watchè£…ç€", icon: "âŒšï¸", isChecked: false, action: null },
                                { id: "h_prep_key", title: "éµã‚’ã¤ã‘ã‚‹", icon: "ğŸ”‘", isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_home_am",
                            title: "åˆå‰",
                            items: [
                                { id: "h_wash", title: "æ´—æ¿¯æ©Ÿã‚’å›ã™", icon: "ğŸ§º", isChecked: false, action: null },
                                { id: "h_dish", title: "é£Ÿæ´—æ©Ÿã®é£Ÿå™¨ã‚’ã—ã¾ã†", icon: "ğŸ½ï¸", isChecked: false, action: null },
                                { id: "h4", title: "æ´—æ¿¯ç‰©ã‚’å¹²ã™", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "h1", title: "ãƒˆã‚¤ãƒ¬æƒé™¤", icon: "ğŸš½", isChecked: false, action: { label: "LINEé€£çµ¡", type: "shortcut", val: "ãƒˆã‚¤ãƒ¬æƒé™¤æ¸ˆã¿" } },
                                { id: "h2", title: "çª“é–‹ã‘", icon: "ğŸªŸ", isChecked: false, action: null },
                                { id: "h3", title: "ãƒ«ãƒ³ãƒç¢ºèª", icon: "ğŸ¤–", isChecked: false, action: null },
                                { id: "h5", title: "é£Ÿæ´—æ©Ÿã‚’ã‹ã‘ã‚‹", icon: "ğŸ½ï¸", isChecked: false, action: null },
                                { id: "h6", title: "ç‰›ä¹³ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆç¢ºèª", icon: "ğŸ¥›", isChecked: false, action: null },
                                { id: "h7", title: "è²·ã„ç‰©ãƒªã‚¹ãƒˆ", icon: "ğŸ›’", isChecked: false, action: { label: "CAJICO", type: "shortcut", val: "CAJICO" } }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_home_pm",
                            title: "åˆå¾Œ",
                            items: [
                                { id: "h8", title: "æ´—æ¿¯ç‰©ã®å–ã‚Šè¾¼ã¿", icon: "ğŸ§º", isChecked: false, action: null },
                                { id: "h9", title: "æ´—æ¿¯ç‰©ç•³ã¿", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "h10", title: "ãƒ‘ã‚¸ãƒ£ãƒæº–å‚™", icon: "ğŸŒ™", isChecked: false, action: null },
                                { id: "h11", title: "ã‚ªãƒ ãƒ„è£œå……", icon: "ğŸ©·", isChecked: false, action: null },
                                { id: "h_window_close", title: "çª“é–‰ã‚", icon: "ğŸªŸ", isChecked: false, action: null },
                                { id: "h12", title: "è¿½ã„ç„šã", icon: "ğŸ”¥", isChecked: false, action: null }
                            ],
                            colorIndex: 1
                        }
                    ]
                },
                // g_nursery (ä¿è‚²åœ’)
                {
                    id: "g_nursery",
                    title: "ä¿è‚²åœ’",
                    icon: "fa-child", // FontAwesome icon
                    editable: false, // å›ºå®šã‚¿ãƒ–
                    subgroups: [
                        {
                            id: "sg_nursery_dropoff_prep",
                            title: "ğŸŒ… ç™»åœ’ï¼šæº–å‚™ãƒ»å¯¾å¿œ",
                            items: [
                                { id: "to2", title: "ä¿è‚²åœ’ã®æ°´ç­’", icon: "ğŸ§´", isChecked: false, action: null },
                                { id: "to3", title: "ã†ãŒã„ã‚³ãƒƒãƒ—", icon: "ğŸ¥¤", isChecked: false, action: null },
                                { id: "to4", title: "ç€æ›¿ãˆæº–å‚™", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "to5", title: "ãƒã‚¤ãƒ‰ãƒ¼ãƒ«", icon: "ğŸ§¸", isChecked: false, action: null },
                                { id: "to6", title: "ç™»åœ’è¨¼ã‚’ã¤ã‘ã‚‹", icon: "ğŸ“›", isChecked: false, action: null },
                                { id: "to7", title: "é´ä¸‹ãƒã‚§ãƒƒã‚¯", icon: "ğŸ§¦", isChecked: false, action: null },
                                { id: "to8", title: "ãŸã¾ã”ãƒœãƒ¼ãƒ­", icon: "ğŸª", isChecked: false, action: null },
                                { id: "to9", title: "æ‰“åˆ»", icon: "ğŸ“²", isChecked: false, action: null }
                            ],
                            colorIndex: 2
                        },
                        {
                            id: "sg_nursery_dropoff_nursery",
                            title: "ğŸ“› ç™»åœ’ï¼šä¿è‚²åœ’",
                            items: [
                                { type: "categoryHeader", title: "æ¯å›" }, // categoryHeader needs separate handling from items
                                { id: "to_n_shoes", title: "é´ã‚’é´ç®±ï¼ˆãã¤ã—ãŸï¼‰", icon: "ğŸ‘Ÿ", isChecked: false, action: null },
                                { id: "to_n_clockin", title: "æ‰“åˆ»", icon: "ğŸ“²", isChecked: false, action: null },
                                { id: "to_n_meet", title: "é›†åˆå ´æ‰€ç¢ºèªï¼ˆå¤–ã€ä¸­ï¼‰", icon: "ğŸ“", isChecked: false, action: null },
                                { id: "to_n_refill", title: "ç€æ›¿ãˆè£œå……", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "to_n_temp", title: "æ¤œæ¸©", icon: "ğŸŒ¡ï¸", isChecked: false, action: null },
                                { id: "to_n_cup", title: "ã‚³ãƒƒãƒ—", icon: "ğŸ¥¤", isChecked: false, action: null },
                                { id: "to_n_doll", title: "ãƒã‚¤ãƒ‰ãƒ¼ãƒ«", icon: "ğŸ§¸", isChecked: false, action: null },
                                { type: "categoryHeader", title: "ä¸­ï¼ˆå®¤å†…ï¼‰" },
                                { id: "to_n_in_bottle", title: "æ°´ç­’", icon: "ğŸ¼", isChecked: false, action: null },
                                { type: "categoryHeader", title: "å¤–ï¼ˆåœ’åº­ï¼‰" },
                                { id: "to_n_out_jacket", title: "ã‚¸ãƒ£ã‚±ãƒƒãƒˆ", icon: "ğŸ§¥", isChecked: false, action: null },
                                { id: "to_n_out_hat", title: "å¸½å­", icon: "ğŸ§¢", isChecked: false, action: null },
                                { id: "to_n_out_socks", title: "ãã¤ã—ãŸ", icon: "ğŸ§¦", isChecked: false, action: null },
                                { id: "to_n_out_shoes", title: "ã‚¯ãƒ„", icon: "ğŸ‘Ÿ", isChecked: false, action: null },
                                { id: "to_n_out_bottle", title: "æ°´ç­’", icon: "ğŸ¼", isChecked: false, action: null }
                            ],
                            colorIndex: 2
                        },
                        {
                            id: "sg_nursery_pickup_go",
                            title: "ğŸŒ† é™åœ’ï¼šãŠè¿ãˆãƒ»è¡Œã",
                            items: [
                                { id: "r3", title: "ã‚¸ãƒ£ã‚±ãƒƒãƒˆ", icon: "ğŸ§¥", isChecked: false, action: null },
                                { id: "r4", title: "ãŠé¢¨å‘‚ã‚’æ²¸ã‹ã™", icon: "ğŸ›€", isChecked: false, action: null },
                                { id: "r5", title: "æ‰“åˆ»", icon: "ğŸ“²", isChecked: false, action: null },
                                { id: "r_fri_futon", title: "é‡‘æ›œï¼šå¸ƒå›£ã‚«ãƒãƒ¼", icon: "ğŸ—“ï¸", isChecked: false, action: null, dynamic: { dayOfWeek: 5 } },
                                { id: "r_fri_cot", title: "é‡‘æ›œï¼šã‚³ãƒƒãƒˆã‚«ãƒãƒ¼", icon: "ğŸ—“ï¸", isChecked: false, action: null, dynamic: { dayOfWeek: 5 } },
                                { id: "r_fri_shoes", title: "é‡‘æ›œï¼šé´", icon: "ğŸ—“ï¸", isChecked: false, action: null, dynamic: { dayOfWeek: 5 } },
                                { id: "r_fri_hat", title: "é‡‘æ›œï¼šå¸½å­", icon: "ğŸ—“ï¸", isChecked: false, action: null, dynamic: { dayOfWeek: 5 } },
                                { id: "r_fri_jacket", title: "é‡‘æ›œï¼šã‚¸ãƒ£ã‚±ãƒƒãƒˆ", icon: "ğŸ—“ï¸", isChecked: false, action: null, dynamic: { dayOfWeek: 5 } }
                            ],
                            colorIndex: 1
                        },
                        {
                            id: "sg_nursery_pickup_home",
                            title: "ğŸ  é™åœ’ï¼šå¸°å®…å¾Œ",
                            items: [
                                { id: "r6", title: "æœã‚’ãƒãƒƒãƒˆã¸", icon: "ğŸ‘•", isChecked: false, action: null },
                                { id: "r7", title: "ã‚ªã‚­ã‚·æ¼¬ã‘", icon: "ğŸ§¼", isChecked: false, action: null },
                                { id: "r_wash_reserve", title: "é¢¨å‘‚å¾Œã«ç¿Œæ—¥ã®æ´—æ¿¯æ©Ÿäºˆç´„", icon: null, isChecked: false, action: { label: "æ™‚é–“", type: "function", val: "calcHours" } }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_nursery_bus_operation",
                            title: "ğŸšŒ ãƒã‚¹é‹è¡Œ",
                            items: [
                                { id: "to1", title: "ãƒã‚¹æ™‚åˆ»è¡¨", icon: "ğŸšŒ", isChecked: false, action: { label: "PDF", type: "url", val: "https://heiwakotsu.com/timefare_baytown/19time_baytown.pdf" } },
                                { id: "r1", title: "ãƒŸãƒ©ãƒªã‚ªã¸", icon: "ğŸšŒ", isChecked: false, action: { label: "PDF", type: "url", val: "https://heiwakotsu.com/timefare_baytown/19time_baytown.pdf" } },
                                { id: "r2", title: "Sãƒ‘ãƒ¼ã‚¯ã¸", icon: "ğŸšŒ", isChecked: false, action: { label: "PDF", type: "url", val: "https://heiwakotsu.com/timefare_baytown/17time_baytown.pdf" } }
                            ],
                            colorIndex: 3
                        }
                    ]
                },
                // g_family (å®¶æ—)
                {
                    id: "g_family",
                    title: "å®¶æ—",
                    icon: "fa-users", // FontAwesome icon
                    editable: false, // å›ºå®šã‚¿ãƒ–
                    subgroups: [
                        {
                            id: "sg_family_child",
                            title: "ğŸ‘§ å­",
                            items: [
                                { id: "child_health_1", title: "å¿ƒç†çš„å®‰å®šæ€§", icon: "ğŸ¤—", isChecked: false, action: null, healthTooltip: { part1Title: "å®‰å…¨åŸºåœ°ã¨ã—ã¦ã®è¦ªã®å­˜åœ¨ç¢ºèª", part1Text: "ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—ã‚’æ„è­˜çš„ã«å¢—ã‚„ã™ã€‚å­ã©ã‚‚ã®æ„Ÿæƒ…ã‚’å—ã‘å…¥ã‚Œã€ãã®èƒŒæ™¯ã‚’ç†è§£ã™ã‚‹ã€‚" } },
                                { id: "child_health_2", title: "ç¡çœ ãƒªã‚ºãƒ ", icon: "ğŸ˜´", isChecked: false, action: null, healthTooltip: { part1Title: "å¤œã®å°±å¯æ™‚åˆ»ã®å›ºå®š", part1Text: "å°±å¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ï¼ˆå…¥æµ´â†’çµµæœ¬â†’æ¶ˆç¯ï¼‰ã‚’å›ºå®šã—ã€ä¼‘æ—¥ã‚‚å¤§ããå´©ã•ãªã„ã€‚" } },
                                { id: "child_health_3", title: "æ „é¤Šç®¡ç†", icon: "ğŸ¥—", isChecked: false, action: null, healthTooltip: { part1Title: "ä¸»é£Ÿãƒ»ä¸»èœãƒ»å‰¯èœã®å‹ã‚’ä½œã‚‹", part1Text: "ã¾ãšã¯ã€Œæœï¼šã‚¿ãƒ³ãƒ‘ã‚¯è³ªã€ã€Œå¤œï¼šé‡èœï¼‹æ±ç‰©ã€ã‚’å›ºå®šã—ã¦è¿·ã„ã‚’æ¸›ã‚‰ã™ã€‚" } },
                                { id: "child_health_5", title: "ç”˜ã„ã‚‚ã®ç®¡ç†", icon: "ğŸ¬", isChecked: false, action: null, healthTooltip: { part1Title: "â€œé‡â€ã‚ˆã‚Šâ€é »åº¦â€ã‚’æ¸›ã‚‰ã™", part1Text: "ãŠã‚„ã¤ã®æ™‚é–“ã‚’å›ºå®šï¼ˆãƒ€ãƒ©ãƒ€ãƒ©é£Ÿã¹ã‚’é¿ã‘ã‚‹ï¼‰ã€‚ç”˜ã„é£²ã¿ç‰©ã¯æ—¥å¸¸åŒ–ã•ã›ãšåŸºæœ¬ã¯æ°´ãƒ»ãŠèŒ¶ã«å¯„ã›ã‚‹ã€‚ç³–ãŒå£å†…ã«æ®‹ã‚‹æ™‚é–“ã‚’çŸ­ãã™ã‚‹è€ƒãˆæ–¹ solasto-career" } },
                                { id: "child_health_6", title: "å™›ã‚€åŠ›ï¼ˆå’€åš¼ï¼‰", icon: "ğŸ¦·", isChecked: false, action: null, healthTooltip: { part1Title: "ã‚ˆãå™›ã‚€ç¿’æ…£ã§é¡ãƒ»æ­¯åˆ—ã®åœŸå°ã‚’ä½œã‚‹", part1Text: "ã€Œæµã—è¾¼ã¿é£Ÿã¹ã€ã‚’æ¸›ã‚‰ã™ï¼ˆã²ã¨å£ã”ã¨ã«é£²ã¿ç‰©ã‚’æŒŸã¾ãªã„ï¼‰ã€‚å™›ã¿ã”ãŸãˆã®ã‚ã‚‹é£Ÿæï¼ˆæ ¹èœã€ãã®ã“ã€åšã‚è‚‰ã€æµ·è—»ãªã©ï¼‰ã‚’â€ç„¡ç†ãªãâ€å¢—ã‚„ã™ã€‚å£è…”æ©Ÿèƒ½ã®è¦³ç‚¹ï¼ˆå’€åš¼ã®ç²å¾—ï¼‰" } },
                                { id: "child_health_7", title: "å£ã®ä½¿ã„æ–¹", icon: "ğŸ‘„", isChecked: false, action: null, healthTooltip: { part1Title: "å”‡ã‚’é–‰ã˜ã¦å™›ã‚€/å£å‘¼å¸ã®ã‚µã‚¤ãƒ³ã‚’æ‹¾ã†", part1Text: "é£Ÿäº‹ä¸­ã«å£ãŒé–‹ããŒã¡ãªã‚‰ã€ŒãŠå£ãƒãƒ£ãƒƒã‚¯ã§ãƒ¢ã‚°ãƒ¢ã‚°ã€ã¨çŸ­ãä¿ƒã™ã€‚å£è…”å‘¨å›²ç­‹ã‚„å£å”‡é–‰é–ã®èª²é¡ŒãŒã‚ã‚‹å ´åˆã¯æ”¯æ´å¯¾è±¡ã«ãªã‚Šå¾—ã‚‹" } },
                                { id: "child_health_8", title: "å™›ã¿æ–¹ã®åã‚Š", icon: "â†”ï¸", isChecked: false, action: null, healthTooltip: { part1Title: "ç‰‡å´å™›ã¿ï¼ˆåå’€åš¼ï¼‰ã‚’æ¸›ã‚‰ã™", part1Text: "å·¦å³ã©ã¡ã‚‰ã§å™›ã‚“ã§ã„ã‚‹ã‹è¦³å¯Ÿã—ã€æ°—ã¥ã„ãŸã‚‰å£°ã‹ã‘ã§åå¯¾å´ã‚‚ä½¿ã†ç·´ç¿’ã€‚åå’€å’€ã®ç¢ºèªã¯è©•ä¾¡é …ç›®ã¨ã—ã¦æŒ™ã’ã‚‰ã‚Œã¦ã„ã‚‹" } },
                                { id: "child_health_9", title: "å—è¨ºãƒ»ç›¸è«‡ã®ç›®å®‰", icon: "ğŸ©º", isChecked: false, action: null, healthTooltip: { part1Title: "å£è…”æ©Ÿèƒ½ã®é…ã‚Œã‚’æ—©ã‚ã«è¦‹æ¥µã‚ã‚‹", part1Text: "ã€Œå™›ã‚ãªã„ã€ã€Œä¸¸å‘‘ã¿ã€ã€Œã‚€ã›ã‚„ã™ã„ã€ã€Œç™ºéŸ³ãŒæ°—ã«ãªã‚‹ã€ã€Œå£ãŒã„ã¤ã‚‚é–‹ã„ã¦ã„ã‚‹ã€ãªã©ãŒç¶šãå ´åˆã€æ­¯ç§‘ï¼ˆå°å…æ­¯ç§‘ï¼‰ã§ç›¸è«‡ã€‚å£è…”æ©Ÿèƒ½ç™ºé”ä¸å…¨ç—‡ã¯æ—©æœŸã®è©•ä¾¡ãƒ»ä»‹å…¥ãŒé‡è¦ã¨ã„ã†è€ƒãˆæ–¹" } },
                                { id: "child_health_10", title: "é‹å‹•ç¿’æ…£", icon: "ğŸƒâ€â™€ï¸", isChecked: false, action: null, healthTooltip: { part1Title: "å…¨èº«ã‚’ä½¿ã†éŠã³ã®â€œæ¯é€±ã®å‹â€", part1Text: "å…¬åœ’éŠã³ãƒ»æ•£æ­©ãƒ»é¬¼ã”ã£ã“ãƒ»ãƒœãƒ¼ãƒ«ãªã©ã€é€±ã®ä¸­ã§å›ºå®šæ ã‚’ä½œã‚‹ï¼ˆå¹³æ—¥çŸ­ã‚ï¼‹ä¼‘æ—¥é•·ã‚ï¼‰ã€‚" } },
                                { id: "child_health_11", title: "ç¤¾ä¼šæ€§", icon: "ğŸ¤", isChecked: false, action: null, healthTooltip: { part1Title: "å‹é”ãƒˆãƒ©ãƒ–ãƒ«ã‚’â€å­¦ã³â€ã«å¤‰ãˆã‚‹", part1Text: "ã¾ãšæ°—æŒã¡ã‚’å—ã‘æ­¢ã‚ã¦ã‹ã‚‰ã€Œæ¬¡ã©ã†ã™ã‚‹ï¼Ÿã€ã¨ä¸€ç·’ã«è€ƒãˆã‚‹ï¼ˆè£ãã‚ˆã‚Šå†ç™ºé˜²æ­¢ã®ä½œæˆ¦ä¼šè­°ï¼‰ã€‚" } },
                                { id: "child_health_12", title: "å­¦ç¿’ï¼ˆå°±å­¦å‰ã®åœŸå°ï¼‰", icon: "ğŸ“š", isChecked: false, action: null, healthTooltip: { part1Title: "ãƒ¯ãƒ¼ã‚¯ã‚ˆã‚Šè¨€èªãƒ»å¥½å¥‡å¿ƒ", part1Text: "çµµæœ¬ã®èª­ã¿èã‹ã›ï¼‹ã€Œã©ã†æ€ã†ï¼Ÿã€ã®ä¼šè©±ã‚’å¢—ã‚„ã™ã€‚æ•°ãƒ»æ–‡å­—ã¯ç”Ÿæ´»ã®ä¸­ï¼ˆè²·ã„ç‰©ã€æ™‚è¨ˆã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼‰ã§è§¦ã‚Œã‚‹ã€‚" } }
                            ],
                            colorIndex: 2
                        },
                        {
                            id: "sg_family_child_info",
                            title: "ğŸ‘¶ è‚²å…æƒ…å ±",
                            items: [
                                { id: "fam_info_sukusuku", title: "ã™ãã™ãå­è‚²ã¦", icon: null, isChecked: false, action: { label: "Link", type: "url", val: "https://www.sukusuku.com/contents/theme/sukusuku" } },
                                { id: "fam_info_hello", title: "ãƒãƒ­ãƒ¼ã¡ã³ã£ã“ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼", icon: null, isChecked: false, action: { label: "NHK", type: "url", val: "https://www.web.nhk/tv/pl/series-tep-QJG2G3956Y" } },
                                { id: "fam_info_nhk_learning", title: "NHKãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°", icon: null, isChecked: false, action: { label: "NHK", type: "url", val: "https://www.web.nhk/tv/an/nlearning/pl/series-tep-61485925G6/list?tep=WX7WG5X11V" } }
                            ],
                            colorIndex: 3
                        },
                        {
                            id: "sg_family_hospital",
                            title: "ğŸ¥ é€šé™¢æ™‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ",
                            items: [
                                { id: "fam_hospital_mynumber_child", title: "å­ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_mynumber_pin", title: "ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æš—è¨¼ç•ªå·", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_benefit_ticket", title: "å—çµ¦åˆ¸", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_temperature", title: "æ¤œæ¸©", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_diaper_set", title: "ãŠã‚€ã¤ã‚»ãƒƒãƒˆ", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_mask", title: "ãƒã‚¹ã‚¯", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_tissues", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_disinfecting_wipes", title: "é™¤èŒã‚·ãƒ¼ãƒˆ", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_water_bottle", title: "æ°´ç­’", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_toys_tablet", title: "ãŠã‚‚ã¡ã‚ƒãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ", icon: null, isChecked: false, action: null },
                                { id: "fam_hospital_change_clothes", title: "ç€æ›¿ãˆ", icon: null, isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_family_wife",
                            title: "ğŸ‘© å¦»",
                            items: [
                                { type: "categoryHeader", title: "ğŸ¥ å¥åº·" }, // categoryHeader needs separate handling from items
                                { id: "fam_wi_health", title: "ãƒªãƒ©ãƒƒã‚¯ã‚¹", icon: "ğŸ›€", isChecked: false, action: null }
                            ],
                            colorIndex: 1
                        },
                        {
                            id: "sg_family_parents",
                            title: "ğŸ‘´ğŸ‘µ çˆ¶æ¯",
                            items: [
                                { type: "categoryHeader", title: "ğŸ¥ å¥åº·" }, // categoryHeader needs separate handling from items
                                { id: "fam_pa_health", title: "ä½“èª¿ç¢ºèª", icon: "ğŸ“", isChecked: false, action: null }
                            ],
                            colorIndex: 4
                        }
                    ]
                },
                // g_other (ãã®ä»–) - Editable
                {
                    id: "g_other",
                    title: "ãã®ä»–",
                    icon: "fa-ellipsis-h", // FontAwesome icon
                    editable: true, // Editable tab
                    subgroups: [
                        {
                            id: "sg_other_sample1",
                            title: "ğŸ“ ã‚µãƒ³ãƒ—ãƒ«ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ— 1",
                            items: [
                                { id: "ot_item1", title: "ã‚µãƒ³ãƒ—ãƒ«é …ç›® A", icon: null, isChecked: false, action: null },
                                { id: "ot_item2", title: "ã‚µãƒ³ãƒ—ãƒ«é …ç›® B", icon: "âœ¨", isChecked: false, action: null }
                            ],
                            colorIndex: 0
                        },
                        {
                            id: "sg_other_sample2",
                            title: "ğŸ’¡ ã‚µãƒ³ãƒ—ãƒ«ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ— 2",
                            items: [
                                { id: "ot_item3", title: "ã‚µãƒ³ãƒ—ãƒ«é …ç›® C", icon: null, isChecked: false, action: null }
                            ],
                            colorIndex: 1
                        },
                        {
                            id: "sg_other_sample3",
                            title: "ğŸš€ ã‚µãƒ³ãƒ—ãƒ«ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ— 3",
                            items: [], // Can be empty
                            colorIndex: 2
                        }
                    ]
                }
            ]
        };

        // --- State Management ---
        let appData = JSON.parse(localStorage.getItem('myChecklistApp')) || defaultData;
        let activeGroupId = appData.groups[0].id;
        let isEditing = false;
        let currentItemForEdit = null; // ç·¨é›†ä¸­ã®é …ç›®ã‚’ä¿æŒ

        // --- Core Logic ---

        function init() {
            // Initial load, check for reset conditions
            checkDateReset();
            // Load active group from localStorage if available, otherwise use first group
            const storedActiveGroupId = localStorage.getItem('activeGroupId');
            if (storedActiveGroupId && appData.groups.some(g => g.id === storedActiveGroupId)) {
                activeGroupId = storedActiveGroupId;
            } else {
                activeGroupId = appData.groups[0].id;
            }

            renderHeader();
            renderTabs();
            renderMain();
        }

        function saveData() {
            localStorage.setItem('myChecklistApp', JSON.stringify(appData));
            localStorage.setItem('activeGroupId', activeGroupId); // Save active group
        }

        // æ—¥ä»˜å¤‰æ›´æ™‚ã®ãƒªã‚»ãƒƒãƒˆå‡¦ç†
        function checkDateReset() {
            const now = new Date();
            const today = now.toISOString().split('T')[0]; // YYYY-MM-DD
            const lastClearDate = appData.appSettings.lastVisitDate;

            if (lastClearDate !== today) {
                appData.groups.forEach(group => {
                    // Only reset groups that are not 'g_other'
                    if (group.id !== 'g_other') {
                        group.subgroups.forEach(subgroup => {
                            subgroup.items.forEach(item => {
                                if (item.type !== "categoryHeader") { // ã‚«ãƒ†ã‚´ãƒªãƒ˜ãƒƒãƒ€ãƒ¼ã¯ãƒªã‚»ãƒƒãƒˆã—ãªã„
                                    item.isChecked = false;
                                }
                            });
                        });
                    }
                });
                appData.appSettings.lastVisitDate = today;
                saveData();
                // No reload here, init() will call render functions
            }
        }

        // --- Rendering ---

        function renderHeader() {
            const now = new Date();
            const days = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
            const dayIdx = now.getDay();

            const dateDisplayEl = document.getElementById('dateDisplay');
            const month = now.getMonth() + 1;
            const date = now.getDate();
            const dayOfWeek = days[dayIdx];

            // Wrap month in a span for separate styling
            dateDisplayEl.innerHTML =
                `<span class="month-display">${month}æœˆ</span><span class="day-display">${date}æ—¥</span> (<span class="day-of-week-display">${dayOfWeek}</span>)`;

            // å‡ºç¤¾æ—¥ãƒãƒƒã‚¸
            const companyBadge = document.getElementById('companyBadge');
            const companyLogoPath = appData.appSettings.companyLogoPath;
            const isWeekend = (dayIdx === 0 || dayIdx === 6);
            if (appData.appSettings.companyDays.includes(dayIdx)) {
                companyBadge.style.display = 'flex'; // Explicitly set display to flex
                companyBadge.innerHTML = `<img src="${companyLogoPath}" alt="BN Logo">å‡ºç¤¾æ—¥`;
            } else if (!isWeekend) {
                companyBadge.style.display = 'flex'; // Or 'block', 'flex' is fine
                companyBadge.innerHTML = 'åœ¨å®…æ—¥';
            } else {
                companyBadge.style.display = 'none'; // Explicitly set display to none
                companyBadge.innerHTML = '';
            }

            // Marquee Random Message
            const msgs = appData.appSettings.marqueeMessages;
            const marqueeTextEl = document.getElementById('marqueeText');
            if (msgs.length > 0) {
                const msg = msgs[Math.floor(Math.random() * msgs.length)];
                marqueeTextEl.innerText = msg;
            } else {
                marqueeTextEl.innerText = '';
            }
            // Marquee animation reset (if needed, though CSS animation usually handles it)
            marqueeTextEl.style.animation = 'none';
            marqueeTextEl.offsetHeight; /* trigger reflow */
            marqueeTextEl.style.animation = null;

            // ã‚°ãƒ«ãƒ¼ãƒ—å›ºæœ‰ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãƒœã‚¿ãƒ³
            const groupHeaderButtonArea = document.getElementById('groupHeaderButtonArea');
            groupHeaderButtonArea.innerHTML = '';
            const currentGroup = appData.groups.find(g => g.id === activeGroupId);
            if (currentGroup && currentGroup.headerButton) {
                const btn = document.createElement('button');
                btn.className = 'reset-button qr-button'; // ä»®ã®ã‚¹ã‚¿ã‚¤ãƒ«
                btn.innerText = currentGroup.headerButton.title;
                // Pass action object directly
                btn.onclick = () => handleAction(currentGroup.headerButton.action);
                groupHeaderButtonArea.appendChild(btn);
            }
        }

        function renderTabs() {
            const nav = document.getElementById('tabBar');
            nav.innerHTML = '';

            const now = new Date();
            const dayIdx = now.getDay(); // 0=Sunday, 1=Monday, ..., 6=Saturday
            const isCompanyDay = appData.appSettings.companyDays.includes(dayIdx);

            // Determine the dynamically red tab based on the day
            let dynamicRedTabId = '';
            if (dayIdx === 0 || dayIdx === 6) { // Sunday or Saturday (weekend)
                dynamicRedTabId = 'g_holiday';
            } else { // Weekday
                if (isCompanyDay) { // Working day
                    dynamicRedTabId = 'g_work';
                } else { // Non-working weekday (remote work)
                    dynamicRedTabId = 'g_home';
                }
            }

            appData.groups.forEach(group => {
                const div = document.createElement('div');
                let classNames = `tab ${group.id === activeGroupId ? 'active' : ''}`;

                // Add 'red-tab' class based on conditions
                if (group.id === 'g_daily' || group.id === 'g_family' || group.id === dynamicRedTabId) {
                    classNames += ' red-tab';
                }

                div.className = classNames;
                div.dataset.groupId = group.id; // ã‚°ãƒ«ãƒ¼ãƒ—IDã‚’ãƒ‡ãƒ¼ã‚¿å±æ€§ã¨ã—ã¦ä¿æŒ
                div.dataset.editable = group.editable; // editableçŠ¶æ…‹ã‚’ãƒ‡ãƒ¼ã‚¿å±æ€§ã¨ã—ã¦ä¿æŒ
                div.onclick = () => {
                    activeGroupId = group.id;
                    saveData(); // Save active group
                    renderHeader(); // Update header (for group specific buttons)
                    renderTabs();
                    renderMain();
                };
                // Font Awesomeã‚¢ã‚¤ã‚³ãƒ³ã¨ã‚¿ã‚¤ãƒˆãƒ«è¡¨ç¤º
                div.innerHTML = `<i class="fas ${group.icon}"></i><span>${group.title}</span>`;
                nav.appendChild(div);
            });
        }

        function renderMain() {
            const container = document.getElementById('mainContent');
            container.innerHTML = '';

            const currentGroup = appData.groups.find(g => g.id === activeGroupId);
            if (!currentGroup) return;

            // ã‚°ãƒ«ãƒ¼ãƒ—ã‚³ãƒ³ãƒ†ãƒŠã« editable å±æ€§ã‚’è¿½åŠ 
            const groupContainer = document.createElement('div');
            groupContainer.className = 'group-content';
            groupContainer.dataset.groupId = currentGroup.id;
            groupContainer.dataset.editable = currentGroup.editable;
            container.appendChild(groupContainer);


            const sgList = document.createElement('div');
            sgList.id = 'subgroupList'; // SortableJSã§ä½¿ç”¨

            // Add QR button for Nursery tab
            if (currentGroup.id === 'g_nursery') {
                const qrButton = document.createElement('button');
                qrButton.className = 'reset-button qr-button';
                qrButton.innerText = 'ğŸ“± ç™»é™åœ’QRã‚’è¡¨ç¤º';
                qrButton.onclick = () => handleAction({ label: "ç™»é™åœ’QR", type: "shortcut", val: "ç™»é™åœ’QR" });
                qrButton.style.marginBottom = '20px'; // Add some space below
                groupContainer.appendChild(qrButton);
            }

            groupContainer.appendChild(sgList); // groupContainerã®å­è¦ç´ ã¨ã—ã¦è¿½åŠ 

            currentGroup.subgroups.forEach((sg, index) => {
                if (sg.hidden) return; // hiddenãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã‚ã‚Œã°ã‚¹ã‚­ãƒƒãƒ—

                const sgEl = document.createElement('div');
                sgEl.className = `subgroup color-${sg.colorIndex !== undefined ? sg.colorIndex : index % 5}`;
                sgEl.dataset.sgId = sg.id;

                let headerHTML = `
                <div class="subgroup-header">
                    <i class="fas fa-bars drag-handle"></i>
                    ${sg.title}
                    <div class="edit-controls">
                        <i class="fas fa-trash delete-btn" onclick="deleteSubgroup('${sg.id}')"></i>
                    </div>
                </div>
            `;

                // Items
                const itemsContainer = document.createElement('div');
                itemsContainer.className = 'items-container';
                itemsContainer.dataset.sgId = sg.id;

                sg.items.forEach(item => {
                    if (item.type === "categoryHeader") {
                        const headerEl = document.createElement('div');
                        headerEl.className = 'category-header';
                        headerEl.innerText = item.title;
                        itemsContainer.appendChild(headerEl);
                        return;
                    }

                    // dynamicæ¡ä»¶ã®ãƒã‚§ãƒƒã‚¯
                    if (item.dynamic) {
                        const now = new Date();
                        const dayOfWeek = now.getDay();
                        const weekNum = Math.ceil(now.getDate() / 7);

                        let shouldDisplay = true;
                        if (item.dynamic.dayOfWeek !== undefined && item.dynamic.dayOfWeek !== dayOfWeek) {
                            shouldDisplay = false;
                        }
                        if (item.dynamic.weekNum && !item.dynamic.weekNum.includes(weekNum)) {
                            shouldDisplay = false;
                        }
                        if (!shouldDisplay) {
                            return; // æ¡ä»¶ã‚’æº€ãŸã•ãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„
                        }
                    }

                    const itemEl = document.createElement('div');
                    itemEl.className = `check-item ${item.isChecked ? 'completed' : ''} ${item.healthTooltip ? 'health-item' : ''}`;
                    itemEl.dataset.itemId = item.id;
                    itemEl.dataset.sgId = sg.id; // è¦ªã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—IDã‚‚ä¿æŒ

                    // healthTooltipã®dataå±æ€§ã‚’è¨­å®š
                    if (item.healthTooltip) {
                        Object.keys(item.healthTooltip).forEach(key => {
                            itemEl.dataset[key] = item.healthTooltip[key];
                        });
                    }

                    let actionButtonHTML = '';
                    if (item.action && !isEditing) { // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
                        if (item.action.type === 'mixed') {
                            actionButtonHTML += `<div class="action-btn-mixed">`;
                            item.action.val.forEach(mixedAction => {
                                let mixedBtnClass = `action-btn ${mixedAction.type}`;
                                let mixedBtnContent = '';
                                if (mixedAction.icon) {
                                    mixedBtnContent += `<img src="${mixedAction.icon}" alt="${mixedAction.label}">`;
                                    mixedBtnClass += ' icon-only-btn'; // Add class if it's an icon button
                                } else {
                                    mixedBtnContent += mixedAction.label;
                                }
                                actionButtonHTML += `<button class="${mixedBtnClass}" onclick="handleAction({ type: '${mixedAction.type}', val: \`${mixedAction.val}\`, label: \`${mixedAction.label}\` })">${mixedBtnContent}</button>`;
                            });
                            actionButtonHTML += `</div>`;
                        } else if (item.action.type === 'image') { // Special handling for image-only buttons (assuming icon is the image source)
                            let imageBtnClass = `action-btn ${item.action.type}`;
                            let imageBtnContent = '';
                            if (item.action.icon) { // Check if icon is explicitly provided for this type
                                imageBtnContent += `<img src="${item.action.icon}" alt="${item.action.label}">`;
                                imageBtnClass += ' icon-only-btn'; // Always icon-only for type 'image' or if icon is present
                            } else { // Fallback if no icon is specified for type 'image' (unlikely but safe)
                                imageBtnContent += item.action.label;
                            }
                            actionButtonHTML += `<button class="${imageBtnClass}" onclick="handleAction({ type: '${item.action.type}', val: \`${item.action.val}\`, label: \`${item.action.label}\` })">${imageBtnContent}</button>`;
                        }
                        else { // For single actions (shortcut, url, modal, function)
                            let singleBtnClass = `action-btn ${item.action.type}`;
                            let singleBtnContent = '';
                            if (item.action.icon) {
                                singleBtnContent += `<img src="${item.action.icon}" alt="${item.action.label}">`;
                                singleBtnClass += ' icon-only-btn'; // Add class if it's an icon button
                            } else {
                                singleBtnContent += item.action.label;
                            }
                            actionButtonHTML += `<button class="${singleBtnClass}" onclick="handleAction({ type: '${item.action.type}', val: \`${item.action.val}\`, label: \`${item.action.label}\` })">${singleBtnContent}</button>`;
                        }
                    }
                    // Handle image icons for item title
                    const itemIconHtml = item.icon ? (item.icon.startsWith('IMG/') ? `<img src="${item.icon}" alt="${item.title}" style="height: 1.2em; vertical-align: middle;">` : item.icon) : '';

                    itemEl.innerHTML = `
                    <div class="check-left" onclick="toggleCheck('${sg.id}', '${item.id}')">
                        <i class="fas fa-bars drag-handle"></i>
                        <div class="checkbox">
                            ${item.isChecked ? '<i class="fas fa-check"></i>' : ''}
                        </div>
                        <div class="item-title">
                            ${itemIconHtml} ${item.title}
                        </div>
                    </div>
                    <div class="item-right-controls">
                        <div class="edit-controls">
                            <button class="edit-icon-btn" onclick="openItemEditModal('${sg.id}', '${item.id}')" ontouchstart="openItemEditModal('${sg.id}', '${item.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-icon-btn" onclick="deleteItem('${sg.id}', '${item.id}')" ontouchstart="deleteItem('${sg.id}', '${item.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        ${actionButtonHTML}
                    </div>
                `;
                    itemsContainer.appendChild(itemEl);
                });

                // Add Item Button (Editing mode)
                const addBtn = document.createElement('div');
                addBtn.className = 'add-item-area';
                addBtn.innerText = '+ é …ç›®ã‚’è¿½åŠ ';
                addBtn.onclick = () => openItemEditModal(sg.id);

                sgEl.innerHTML += headerHTML; // Append header HTML correctly
                sgEl.appendChild(itemsContainer);
                sgEl.appendChild(addBtn);
                sgList.appendChild(sgEl);
            });

            // Group Add Subgroup (Editing mode)
            const addSgBtn = document.createElement('div');
            addSgBtn.className = 'add-item-area';
            addSgBtn.style.marginBottom = '20px';
            addSgBtn.innerText = '+ ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¿½åŠ ';
            addSgBtn.onclick = () => addSubgroup();
            groupContainer.appendChild(addSgBtn); // groupContainerã®å­è¦ç´ ã¨ã—ã¦è¿½åŠ 

            // ã€Œå…¨ãƒã‚§ãƒƒã‚¯ãƒªã‚»ãƒƒãƒˆã€ãƒœã‚¿ãƒ³
            const allResetButton = document.createElement('button');
            allResetButton.className = 'reset-button';
            allResetButton.innerText = 'å…¨ãƒã‚§ãƒƒã‚¯ãƒªã‚»ãƒƒãƒˆ';
            allResetButton.onclick = allReset;
            groupContainer.appendChild(allResetButton);

            // ã€Œãã®ä»–ã€ã‚¿ãƒ–å°‚ç”¨ã®ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
            if (activeGroupId === 'g_other') {
                const otherResetButton = document.createElement('button');
                otherResetButton.className = 'reset-button'; // Re-use existing button style
                otherResetButton.innerText = 'ãã®ä»–ã‚¿ãƒ–ã‚’ãƒªã‚»ãƒƒãƒˆ';
                otherResetButton.onclick = resetOtherTab;
                groupContainer.appendChild(otherResetButton);
            }


            // SortableJSã®é©ç”¨
            if (isEditing && currentGroup.editable) { // ã‚°ãƒ«ãƒ¼ãƒ—ãŒeditableã®å ´åˆã®ã¿Sortableã‚’é©ç”¨
                // ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸¦ã³æ›¿ãˆ
                new Sortable(sgList, {
                    handle: '.drag-handle',
                    animation: 150,
                    onEnd: function (evt) {
                        const sgId = evt.item.dataset.sgId; // Get sgId from the dragged item
                        const sgIndex = currentGroup.subgroups.findIndex(sg => sg.id === sgId);
                        if (sgIndex !== -1) {
                            const [item] = currentGroup.subgroups.splice(sgIndex, 1);
                            currentGroup.subgroups.splice(evt.newIndex, 0, item);
                            saveData();
                            renderMain(); // å¤‰æ›´ã‚’åæ˜ 
                        }
                    }
                });

                // å„ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®é …ç›®ã®ä¸¦ã³æ›¿ãˆ
                document.querySelectorAll('.items-container').forEach(el => {
                    const sgId = el.dataset.sgId;
                    const sg = currentGroup.subgroups.find(s => s.id === sgId);

                    if (sg && sg.items.some(item => item.type !== 'categoryHeader')) { // Only enable sortable if there are actual items (not just headers)
                        new Sortable(el, {
                            handle: '.drag-handle',
                            animation: 150,
                            group: 'items', // ã‚°ãƒ«ãƒ¼ãƒ—å†…ã§ä¸¦ã³æ›¿ãˆ
                            filter: '.category-header', // ã‚«ãƒ†ã‚´ãƒªãƒ˜ãƒƒãƒ€ãƒ¼ã¯ãƒ‰ãƒ©ãƒƒã‚°å¯¾è±¡å¤–
                            onEnd: function (evt) {
                                const sgId = evt.from.dataset.sgId;
                                const sg = currentGroup.subgroups.find(s => s.id === sgId);
                                if (!sg) return;

                                // Filter out category headers before moving
                                const actualItems = sg.items.filter(item => item.type !== 'categoryHeader');
                                const categoryHeaders = sg.items.filter(item => item.type === 'categoryHeader');

                                const movedItem = actualItems.splice(evt.oldIndex, 1)[0];
                                actualItems.splice(evt.newIndex, 0, movedItem);

                                // Reinsert category headers into their original relative positions or just at the top
                                const newItems = [];
                                let itemIdx = 0;
                                for (let i = 0; i < sg.items.length; i++) {
                                    if (sg.items[i].type === 'categoryHeader') {
                                        newItems.push(sg.items[i]);
                                    } else {
                                        if (itemIdx < actualItems.length) {
                                            newItems.push(actualItems[itemIdx]);
                                            itemIdx++;
                                        }
                                    }
                                }
                                sg.items = newItems;
                                saveData();
                                renderMain(); // å¤‰æ›´ã‚’åæ˜ 
                            }
                        });
                    }
                });
            }
            setupHealthTooltips(); // renderMainå¾Œã«ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’åˆæœŸåŒ–
        }

        // --- Actions ---

        function handleAction(action) {
            if (!action || !action.type || !action.val) return;

            if (action.type === 'shortcut') {
                runShortcut(action.val);
            } else if (action.type === 'url') {
                openLink(action.val);
            } else if (action.type === 'modal') {
                openModal(action.val);
            } else if (action.type === 'function') {
                if (typeof window[action.val] === 'function') {
                    window[action.val]();
                }
            }
            // mixedã‚¿ã‚¤ãƒ—ã¯renderMainã§å€‹åˆ¥ã«å‡¦ç†ã•ã‚Œã‚‹ãŸã‚ã€ã“ã“ã«ã¯åˆ°é”ã—ãªã„æƒ³å®š
        }

        function toggleCheck(sgId, itemId) {
            if (isEditing) return; // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ãƒã‚§ãƒƒã‚¯ä¸å¯
            const group = appData.groups.find(g => g.id === activeGroupId);
            const sg = group.subgroups.find(s => s.id === sgId);
            const item = sg.items.find(i => i.id === itemId);

            item.isChecked = !item.isChecked;
            saveData();
            renderMain(); // Re-render to show check
        }

        function toggleEditMode() {
            isEditing = !isEditing;
            document.body.classList.toggle('editing', isEditing);
            document.getElementById('editStatus').innerText = isEditing ? "ç·¨é›†ä¸­" : "";

            if (isEditing) {
                renderSettingsModal(); // è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãå‰ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
                openModal('settingsModal');
            } else {
                closeModal('settingsModal');
                // Re-render main content to hide edit controls and re-enable check
                renderMain();
            }
        }

        function showMeetingsModal() {
            const now = new Date();
            const dayIdx = now.getDay();

            const meetingsListEl = document.getElementById('meetingsList');
            if (!meetingsListEl) {
                openModal('meetingsModal'); // Still open the modal to show something
                // Consider logging to console if in a debug environment, but for user-facing, just open.
                return;
            }

            if (!appData || !appData.appSettings || !appData.appSettings.meetingSchedule) {
                meetingsListEl.innerHTML = '<p>ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒèª­ã¿è¾¼ã‚ã¾ã›ã‚“ã€‚è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>';
                openModal('meetingsModal');
                return;
            }

            const meetingsToday = appData.appSettings.meetingSchedule[dayIdx];

            if (meetingsToday && meetingsToday.length > 0) {
                meetingsListEl.innerHTML = meetingsToday.map(mtg => `<p>ãƒ» ${mtg}</p>`).join('');
            } else {
                meetingsListEl.innerHTML = '<p>ä»Šæ—¥ã®MTGã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
            }
            openModal('meetingsModal');
        }

        // --- Settings Functions ---
        function renderSettingsModal() {
            const companyDaysEditDiv = document.getElementById('companyDaysEdit');
            companyDaysEditDiv.innerHTML = ''; // ã‚¯ãƒªã‚¢
            const daysOfWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];

            daysOfWeek.forEach((day, index) => {
                const label = document.createElement('label');
                label.style.display = 'flex';
                label.style.flexDirection = 'column';
                label.style.alignItems = 'center';
                label.style.cursor = 'pointer';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.value = index;
                checkbox.checked = appData.appSettings.companyDays.includes(index);
                checkbox.id = `companyDay-${index}`;
                checkbox.style.transform = 'scale(1.5)';
                checkbox.style.marginBottom = '5px';

                label.appendChild(checkbox);
                label.appendChild(document.createTextNode(day));
                companyDaysEditDiv.appendChild(label);
            });

            // marqueeMessagesEdit ã«ç¾åœ¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            document.getElementById('marqueeMessagesEdit').value = appData.appSettings.marqueeMessages.join('\n');
        }

        function saveSettings() {
            // companyDaysã®ä¿å­˜
            const companyDaysCheckboxes = document.querySelectorAll('#companyDaysEdit input[type="checkbox"]');
            appData.appSettings.companyDays = Array.from(companyDaysCheckboxes)
                .filter(cb => cb.checked)
                .map(cb => parseInt(cb.value));

            // marqueeMessagesã®ä¿å­˜
            const marqueeMessagesTextarea = document.getElementById('marqueeMessagesEdit');
            appData.appSettings.marqueeMessages = marqueeMessagesTextarea.value
                .split('\n')
                .map(msg => msg.trim())
                .filter(msg => msg !== ''); // ç©ºè¡Œã¯é™¤å¤–

            saveData();
            renderHeader(); // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ›´æ–°ã—ã¦å‡ºç¤¾æ—¥ãƒãƒƒã‚¸ã¨ãƒãƒ¼ã‚­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’åæ˜ 
            closeModal('settingsModal');
        }

        function addMarqueeMessage() {
            const marqueeMessagesTextarea = document.getElementById('marqueeMessagesEdit');
            const newMessage = prompt("æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:");
            if (newMessage && newMessage.trim() !== '') {
                if (marqueeMessagesTextarea.value.trim() !== '') {
                    marqueeMessagesTextarea.value += '\n';
                }
                marqueeMessagesTextarea.value += newMessage.trim();
            }
        }

        function removeMarqueeMessage() {
            const marqueeMessagesTextarea = document.getElementById('marqueeMessagesEdit');
            const messages = marqueeMessagesTextarea.value.split('\n').map(msg => msg.trim()).filter(msg => msg !== '');

            if (messages.length === 0) {
                alert("å‰Šé™¤ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
                return;
            }

            const messageToDelete = prompt("å‰Šé™¤ã—ãŸã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ­£ç¢ºã«å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆéƒ¨åˆ†ä¸€è‡´ã§ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰:", messages[messages.length - 1]);
            if (messageToDelete) {
                const filteredMessages = messages.filter(msg => msg !== messageToDelete.trim());
                marqueeMessagesTextarea.value = filteredMessages.join('\n');
            }
        }


        // --- CRUD (Simplified for Prototype) ---

        // é …ç›®è¿½åŠ ãƒ»ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
        function openItemEditModal(sgId, itemId = null) {
            currentItemForEdit = { sgId: sgId, itemId: itemId };
            const itemEditModal = document.getElementById('itemEditModal');
            const editItemTitle = document.getElementById('editItemTitle');
            const editItemIcon = document.getElementById('editItemIcon');
            const editItemActionType = document.getElementById('editItemActionType');
            const editItemActionValGroup = document.getElementById('editItemActionValGroup');
            const editItemActionVal = document.getElementById('editItemActionVal');
            const editItemActionLabelGroup = document.getElementById('editItemActionLabelGroup');
            const editItemActionLabel = document.getElementById('editItemActionLabel');
            const editItemActionIconGroup = document.getElementById('editItemActionIconGroup');
            const editItemActionIcon = document.getElementById('editItemActionIcon');

            // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é–¢é€£ã®è¡¨ç¤ºåˆ¶å¾¡
            const toggleActionFields = () => {
                const selectedType = editItemActionType.value;
                if (selectedType === 'none') {
                    editItemActionValGroup.style.display = 'none';
                    editItemActionLabelGroup.style.display = 'none';
                    editItemActionIconGroup.style.display = 'none';
                } else {
                    editItemActionValGroup.style.display = 'block';
                    editItemActionLabelGroup.style.display = 'block';
                    editItemActionIconGroup.style.display = 'block';
                }
            };
            editItemActionType.onchange = toggleActionFields;

            if (itemId) { // æ—¢å­˜é …ç›®ç·¨é›†
                const group = appData.groups.find(g => g.id === activeGroupId);
                const sg = group.subgroups.find(s => s.id === sgId);
                const item = sg.items.find(i => i.id === itemId);

                editItemTitle.value = item.title;
                editItemIcon.value = item.icon || '';
                if (item.action) {
                    editItemActionType.value = item.action.type;
                    editItemActionVal.value = typeof item.action.val === 'string' ? item.action.val : JSON.stringify(item.action.val); // Handle mixed action type
                    editItemActionLabel.value = item.action.label || '';
                    editItemActionIcon.value = item.action.icon || '';
                } else {
                    editItemActionType.value = 'none';
                    editItemActionVal.value = '';
                    editItemActionLabel.value = '';
                    editItemActionIcon.value = '';
                }
            } else { // æ–°è¦é …ç›®è¿½åŠ 
                editItemTitle.value = '';
                editItemIcon.value = '';
                editItemActionType.value = 'none';
                editItemActionVal.value = '';
                editItemActionLabel.value = '';
                editItemActionIcon.value = '';
            }

            toggleActionFields(); // åˆæœŸè¡¨ç¤º

            openModal('itemEditModal');
        }

        // é …ç›®ç·¨é›†å†…å®¹ã‚’ä¿å­˜
        function saveEditedItem() {
            const { sgId, itemId } = currentItemForEdit;
            const group = appData.groups.find(g => g.id === activeGroupId);
            const sg = group.subgroups.find(s => s.id === sgId);

            const title = document.getElementById('editItemTitle').value;
            const icon = document.getElementById('editItemIcon').value || null;
            const actionType = document.getElementById('editItemActionType').value;
            const actionValRaw = document.getElementById('editItemActionVal').value;
            const actionLabel = document.getElementById('editItemActionLabel').value;
            const actionIcon = document.getElementById('editItemActionIcon').value || null;

            let action = null;
            if (actionType !== 'none') {
                let actionVal = actionValRaw;
                if (actionType === 'mixed') {
                    try {
                        actionVal = JSON.parse(actionValRaw);
                    } catch (e) {
                        alert('Mixedã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å€¤ã¯JSONå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                        return;
                    }
                }
                action = { type: actionType, val: actionVal, label: actionLabel, icon: actionIcon };
            }

            if (itemId) { // æ—¢å­˜é …ç›®ã‚’æ›´æ–°
                const item = sg.items.find(i => i.id === itemId);
                item.title = title;
                item.icon = icon;
                item.action = action;
            } else { // æ–°è¦é …ç›®ã‚’è¿½åŠ 
                // Ensure unique ID for new item
                let newItemId = 'it_' + Date.now();
                while (sg.items.some(item => item.id === newItemId)) {
                    newItemId = 'it_' + Date.now() + Math.floor(Math.random() * 100);
                }
                sg.items.push({
                    id: newItemId,
                    title: title,
                    icon: icon,
                    isChecked: false,
                    action: action
                });
            }
            saveData();
            renderMain();
            closeModal('itemEditModal');
        }


        function deleteItem(sgId, itemId) {
            if (!confirm("é …ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
            const group = appData.groups.find(g => g.id === activeGroupId);
            if (!group || !group.editable) { // å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—ã®é …ç›®ã¯å‰Šé™¤ä¸å¯
                alert("ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®é …ç›®ã¯å‰Šé™¤ã§ãã¾ã›ã‚“ã€‚");
                return;
            }

            const sg = group.subgroups.find(s => s.id === sgId);
            sg.items = sg.items.filter(i => i.id !== itemId);
            saveData();
            renderMain();
        }

        function addSubgroup() {
            const currentGroup = appData.groups.find(g => g.id === activeGroupId);
            if (!currentGroup || !currentGroup.editable) { // å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ ä¸å¯
                alert("ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¿½åŠ ã§ãã¾ã›ã‚“ã€‚");
                return;
            }

            const title = prompt("ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            if (!title) return;

            const newColorIndex = currentGroup.subgroups.length % 5; // è‡ªå‹•é…è‰²
            currentGroup.subgroups.push({
                id: 'sg_' + Date.now(),
                title: title,
                items: [],
                colorIndex: newColorIndex
            });
            saveData();
            renderMain();
        }

        function deleteSubgroup(sgId) {
            if (!confirm("ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
            const currentGroup = appData.groups.find(g => g.id === activeGroupId);
            if (!currentGroup || !currentGroup.editable) { // å›ºå®šã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã¯å‰Šé™¤ä¸å¯
                alert("ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã¯å‰Šé™¤ã§ãã¾ã›ã‚“ã€‚");
                return;
            }

            currentGroup.subgroups = currentGroup.subgroups.filter(s => s.id !== sgId);
            saveData();
            renderMain();
        }

        // --- Modal Functions (checklist_daily/index.htmlã‹ã‚‰çµ±åˆ) ---
        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function submitAIPlan() {
            const start = document.getElementById('startTime').value;
            const end = document.getElementById('endTime').value;
            const place = document.getElementById('placeSelect').value;
            const transport = document.getElementById('transportSelect').value;
            const facility = document.getElementById('facilityCount').value;
            const plans = document.getElementById('planCount').value;
            const env = document.getElementById('envSelect').value;
            const free = document.getElementById('freeText').value;

            const prompt = `[ã‚·ã‚¹ãƒ†ãƒ å‘½ä»¤: Pro Searchæ©Ÿèƒ½ã‚’å¼·åˆ¶ONã«ã—ã¦ã€ã‚¦ã‚§ãƒ–æ¤œç´¢ã‚’é§†ä½¿ã—ã¦ãã ã•ã„]åƒè‘‰å¸‚ç¾æµœåŒºæ‰“ç€¬ã‚’å‡ºç™ºåœ°ç‚¹ã¨ã—ã¦ã€å®¶æ—ä¸‰äºº(å¤«å©¦ã€2021å¹´ç”Ÿã¾ã‚Œå¥³ã®å­)ãŒæ¥½ã—ã‚ã‚‹ãŠã§ã‹ã‘è¨ˆç”»ã‚’ç«‹ã¦ã¦ä¸‹ã•ã„ã€‚ä»¥ä¸‹ã®æ¡ä»¶ï¼ˆå­£ç¯€ã€æ°—æ¸©ã€æ—¥æœ¬ã®é¢¨ç¿’ã‚’è€ƒæ…®ï¼‰ã‚’å…ƒã«ã€æœ€æ–°æƒ…å ±ã‚’ãƒªã‚µãƒ¼ãƒã—ã¦ã€${plans}å€‹ã€‘ã®ãƒ—ãƒ©ãƒ³ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚#å‡ºåŠ›å½¢å¼:ãƒ»å¿…ãšãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã®ã€ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã€‘ï¼ˆæ™‚åˆ»ã€å†…å®¹ã€è²»ç”¨ï¼‰ã§å‡ºåŠ›ã€‚ãƒ»ãƒ—ãƒ©ãƒ³æ¯ã«å¿…ãšã€è²»ç”¨åˆè¨ˆã€‘ã‚’è¡¨ç¤ºã€‚ãƒ»ã‚«ãƒ¼ã‚·ã‚§ã‚¢è²»ç”¨ã¯ã€Œ1æ—¥5,000å††ã€ã¨ã—ã¦è¨ˆç®—ã€‚#ãƒªã‚µãƒ¼ãƒæŒ‡ç¤º:ãƒ»2026å¹´ç¾åœ¨ã®å–¶æ¥­æ™‚é–“ã€åˆ©ç”¨æ–™é‡‘ã€æœ€æ–°ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚¦ã‚§ãƒ–æ¤œç´¢ã€‚ãƒ»å­£ç¯€ãƒ»æ°—æ¸©ãƒ»æ—¥æœ¬ã®é¢¨ç¿’ï¼ˆç¥æ—¥ã‚„è¡Œäº‹ï¼‰ã‚’è€ƒæ…®ã—ãŸå†…å®¹ã«ã™ã‚‹ã€‚ãƒ»æ‰“ç€¬ã‹ã‚‰ã®æ­£ç¢ºãªç§»å‹•ãƒ«ãƒ¼ãƒˆ/æ™‚é–“ã‚’ãƒªã‚µãƒ¼ãƒã€‚ãƒ»ãƒ©ãƒ³ãƒã¯ç›®çš„åœ°ã‹ã‚‰å¾’æ­©5åˆ†ä»¥å†…ã€ã‹ã¤å­é€£ã‚Œæ­“è¿ã®åº—ã‚’ç‰¹å®šã€‚#åˆ¶ç´„æ¡ä»¶:ãƒ»å‡ºç™ºåœ°ï¼šåƒè‘‰å¸‚ç¾æµœåŒºæ‰“ç€¬ãƒ»ãƒ©ãƒ³ãƒæ™‚é–“ï¼š10:30ã€œ11:00ãƒ»ã‚ãã‚‹æ–½è¨­æ•°ï¼š${facility}ãƒ»ç§»å‹•æ‰‹æ®µï¼š${transport}#å…¥åŠ›ãƒ‡ãƒ¼ã‚¿:å‡ºç™ºï¼š${start}ã€å¸°å®…ï¼š${end}ã€å ´æ‰€ï¼š${place}ã€ç’°å¢ƒï¼š${env}ã€å‚™è€ƒï¼š${free}å‡ºåŠ›ï¼šã€çµè«–(ãƒ†ãƒ¼ãƒ–ãƒ«)ã€‘ã€è²»ç”¨åˆè¨ˆã€‘ã€ãƒªã‚µãƒ¼ãƒæ ¹æ‹ ã€‘ã€æ³¨æ„ç‚¹ã€‘ã€å‡ºå…¸ã€‘`;
            window.open("https://www.perplexity.ai/search?q=" + encodeURIComponent(prompt) + "&copilot=1", '_blank');
            closeModal('aiModal');
        }

        function submitTravelPlan() {
            const holiday = document.getElementById('trHoliday').value;
            const stay = document.getElementById('trStay').value;
            const place = document.getElementById('trPlace').value;
            const transport = document.getElementById('trTransport').value;
            const facility = document.getElementById('trFacility').value;
            const plans = document.getElementById('trPlans').value;
            const env = document.getElementById('trEnv').value;
            const free = document.getElementById('trFree').value;

            const prompt = `[Pro Searchæ©Ÿèƒ½ON]åƒè‘‰å¸‚ç¾æµœåŒºæ‰“ç€¬ã‚’å‡ºç™ºåœ°ç‚¹ã¨ã—ã¦ã€å®¶æ—ä¸‰äºº(å¤«å©¦ã€2021å¹´ç”Ÿã¾ã‚Œå¥³ã®å­)å‘ã‘ã®æ—…è¡Œè¨ˆç”»ã‚’${plans}å€‹ææ¡ˆã—ã¦ãã ã•ã„ã€‚æ—¥ç¨‹ã¯ã€${holiday}ã€‘ã‚’å‰æã¨ã—ã€æœŸé–“ã¯${stay}ã¨ã—ã¾ã™ã€‚ç›®çš„åœ°ã¯${place}ã€ãƒ†ãƒ¼ãƒã¯${env}ã€ç§»å‹•æ‰‹æ®µã¯${transport}ã€1æ—¥${facility}æ–½è¨­ã‚’å·¡ã‚‹æƒ³å®šã§ã€è²»ç”¨æ¦‚ç®—ã‚‚å«ã‚ã¦ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚å‚™è€ƒï¼š${free}`;
            window.open("https://www.perplexity.ai/search?q=" + encodeURIComponent(prompt) + "&copilot=1", '_blank');
            closeModal('travelModal');
        }

        function calcLeaveTime() {
            const now = new Date();
            const start = new Date(now.getTime() + 10 * 60000); // +10 min
            const end = new Date(start.getTime() + 60 * 60000); // +1 hour

            const format = (d) => d.getHours().toString().padStart(2, '0') + ':' + d.getMinutes().toString().padStart(2, '0');
            const res = format(start) + '-' + format(end);
            alert(res);
        }

        function calcHours() { // btnå¼•æ•°ã‚’å‰Šé™¤
            // å‘¼ã³å‡ºã—å…ƒãŒã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®å ´åˆã¯eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ¸¡ã•ã‚Œã‚‹ãŒã€ã“ã“ã§ã¯ç›´æ¥å‘¼ã³å‡ºã™æƒ³å®š
            // å¿…è¦ã§ã‚ã‚Œã°ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ç‰¹å®šã—ã¦innerTextã‚’æ›´æ–°ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ 
            const now = new Date();
            let target = new Date();
            target.setHours(6, 0, 0, 0);
            if (now.getHours() >= 6) {
                target.setDate(now.getDate() + 1);
            }
            const diffMs = target - now;
            const diffHrs = (diffMs / (1000 * 60 * 60)).toFixed(1);
            alert(`${diffHrs}hå¾Œ`); // ãƒœã‚¿ãƒ³ã®innerTextã§ã¯ãªãã‚¢ãƒ©ãƒ¼ãƒˆã§è¡¨ç¤ºï¼ˆä»®ï¼‰
        }

        function runShortcut(name) { window.location.href = 'shortcuts://run-shortcut?name=' + encodeURIComponent(name); }
        function openLink(url) { window.open(url, '_blank'); }

        function allReset() {
            if (confirm('ã€Œãã®ä»–ã€ã‚¿ãƒ–ã‚’é™¤ãå…¨ã¦ã®ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚')) {
                appData.groups.forEach(group => {
                    // Only reset groups that are not 'g_other'
                    if (group.id !== 'g_other') {
                        group.subgroups.forEach(subgroup => {
                            subgroup.items.forEach(item => {
                                if (item.type !== "categoryHeader") {
                                    item.isChecked = false;
                                }
                            });
                        });
                    }
                });
                saveData();
                location.reload();
            }
        }

        function resetOtherTab() {
            if (confirm('ã€Œãã®ä»–ã€ã‚¿ãƒ–ã®ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã‚’å…¨ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                const otherGroup = appData.groups.find(g => g.id === 'g_other');
                if (otherGroup) {
                    otherGroup.subgroups.forEach(subgroup => {
                        subgroup.items.forEach(item => {
                            if (item.type !== "categoryHeader") {
                                item.isChecked = false;
                            }
                        });
                    });
                    saveData();
                    renderMain(); // Re-render the current tab to show changes
                }
            }
        }


        // --- Health Tooltip Logic (checklist_daily/index.htmlã‹ã‚‰çµ±åˆãƒ»èª¿æ•´) ---
        function setupHealthTooltips() {
            // Create tooltip element if it doesn't exist
            let tooltip = document.getElementById('health-tooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.id = 'health-tooltip';
                tooltip.className = 'health-tooltip';
                document.body.appendChild(tooltip);
            }

            // æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€é‡è¤‡ç™»éŒ²ã‚’é˜²ã
            // renderMainãŒæ¯å›DOMã‚’å†ç”Ÿæˆã™ã‚‹ãŸã‚ã€æ—¢å­˜ãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ã¯ãªã„
            // ãŸã ã—ã€ã‚‚ã—DOMãŒå†ç”Ÿæˆã•ã‚Œãªã„å ´åˆã¯ã€removeEventListenerã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

            document.querySelectorAll('.health-item').forEach(item => {
                // Check if event listener already added to prevent duplicates on re-render
                if (item.dataset.hasTooltipListener) {
                    return;
                }
                item.dataset.hasTooltipListener = 'true'; // Mark as having listener

                item.addEventListener('click', function (event) {
                    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹è‡ªä½“ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸå ´åˆã¯ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’è¡¨ç¤ºã—ãªã„
                    if (event.target.type === 'checkbox' || event.target.closest('.checkbox')) {
                        return;
                    }
                    event.stopPropagation(); // è¦ªè¦ç´ ã¸ã®ã‚¤ãƒ™ãƒ³ãƒˆä¼æ’­ã‚’åœæ­¢

                    let tooltipContent = '';

                    // data-partX-title ã¨ data-partX-text ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å‹•çš„ã«æ§‹ç¯‰
                    for (let i = 1; i <= 3; i++) { // æœ€å¤§3ãƒ‘ãƒ¼ãƒˆã‚’æƒ³å®š
                        const title = this.dataset[`part${i}Title`];
                        const text = this.dataset[`part${i}Text`];
                        if (title && text) {
                            tooltipContent += `
                            <div class="health-tooltip-section">
                                <strong>${title}</strong>
                                <p>${text}</p>
                            </div>
                        `;
                        }
                    }

                    // åŒã˜é …ç›®ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã€ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ãŒè¡¨ç¤ºä¸­ã®å ´åˆã¯éè¡¨ç¤ºã«ã™ã‚‹
                    if (tooltip.style.display === 'block' && tooltip.dataset.currentItemId === this.dataset.itemId) {
                        tooltip.style.display = 'none';
                        return;
                    }

                    tooltip.innerHTML = tooltipContent;

                    const rect = this.getBoundingClientRect();
                    tooltip.style.display = 'block';

                    // æœ€é©ãªä½ç½®ã‚’è¨ˆç®—
                    let finalLeft = rect.left;
                    let finalTop = rect.bottom + 5; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½ç½®: é …ç›®ã®ä¸‹

                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    const tooltipRect = tooltip.getBoundingClientRect(); // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ãƒƒãƒˆå¾Œã®ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã®å¯¸æ³•ã‚’å–å¾—

                    // æ°´å¹³æ–¹å‘ã®èª¿æ•´
                    if (finalLeft + tooltipRect.width > viewportWidth - 10) {
                        finalLeft = viewportWidth - tooltipRect.width - 10;
                    }
                    if (finalLeft < 10) { // å·¦ç«¯ã§è¦‹åˆ‡ã‚Œãªã„ã‚ˆã†ã«
                        finalLeft = 10;
                    }

                    // å‚ç›´æ–¹å‘ã®èª¿æ•´ï¼ˆä¸Šéƒ¨ã«è¡¨ç¤ºã™ã‚‹ã‹ã€ä¸‹éƒ¨ã«è¡¨ç¤ºã™ã‚‹ã‹ï¼‰
                    const spaceBelow = viewportHeight - (rect.bottom + 5);
                    const spaceAbove = rect.top - tooltipRect.height - 5;

                    if (spaceBelow < tooltipRect.height && spaceAbove > 0) {
                        // ä¸‹éƒ¨ã«ååˆ†ãªã‚¹ãƒšãƒ¼ã‚¹ãŒãªãã€ä¸Šéƒ¨ã«ååˆ†ãªã‚¹ãƒšãƒ¼ã‚¹ãŒã‚ã‚‹å ´åˆã€ä¸Šéƒ¨ã«åè»¢
                        finalTop = rect.top - tooltipRect.height - 5;
                    } else if (finalTop + tooltipRect.height > viewportHeight - 10) {
                        // ä¸‹éƒ¨ã«ã¾ã è¦‹åˆ‡ã‚Œã‚‹å ´åˆã€ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®ä¸‹ç«¯ã«åˆã‚ã›ã‚‹
                        finalTop = viewportHeight - tooltipRect.height - 10;
                    }
                    if (finalTop < 10) { // ä¸Šç«¯ã§è¦‹åˆ‡ã‚Œãªã„ã‚ˆã†ã«
                        finalTop = 10;
                    }

                    tooltip.style.left = `${finalLeft}px`;
                    tooltip.style.top = `${finalTop}px`;

                    tooltip.dataset.currentItemId = this.dataset.itemId;
                });
            });

            // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’å¤–å´ã‚¯ãƒªãƒƒã‚¯ã§éè¡¨ç¤º
            document.addEventListener('click', function (event) {
                if (tooltip && tooltip.style.display === 'block') {
                    if (!tooltip.contains(event.target) && !event.target.closest('.health-item') && !event.target.closest('.settings-btn')) {
                        tooltip.style.display = 'none';
                    }
                }
            });
        }


        /* --- Swipe Functionality (Disabled by user request) ---
        let touchStartX = 0;
        let touchEndX = 0;
    
        const mainContent = document.getElementById('mainContent');
    
        mainContent.addEventListener('touchstart', e => {
            touchStartX = e.touches[0].clientX;
            // Prevent scrolling if drag-and-drop is active (editing mode),
            // but allow clicks on 'add-item-area' buttons
            if (isEditing && !e.target.closest('.add-item-area')) {
                e.preventDefault(); 
            }
        });
    
        mainContent.addEventListener('touchmove', e => {
            touchEndX = e.touches[0].clientX;
        });
    
        mainContent.addEventListener('touchend', () => {
            if (isEditing) { // Disable swipe if in editing mode
                touchStartX = 0;
                touchEndX = 0;
                return;
            }
    
            if (touchStartX === 0 || touchEndX === 0) return;
    
            const threshold = 50; // ã‚¹ãƒ¯ã‚¤ãƒ—ã¨åˆ¤å®šã™ã‚‹æœ€å°è·é›¢
            const deltaX = touchEndX - touchStartX;
    
            if (Math.abs(deltaX) > threshold) {
                const currentGroupIndex = appData.groups.findIndex(g => g.id === activeGroupId);
                let newGroupIndex = -1;
    
                if (deltaX > 0) { // å³ã‚¹ãƒ¯ã‚¤ãƒ— (å‰ã®ã‚¿ãƒ–ã¸)
                    newGroupIndex = currentGroupIndex - 1;
                } else { // å·¦ã‚¹ãƒ¯ã‚¤ãƒ— (æ¬¡ã®ã‚¿ãƒ–ã¸)
                    newGroupIndex = currentGroupIndex + 1;
                }
    
                if (newGroupIndex >= 0 && newGroupIndex < appData.groups.length) {
                    activeGroupId = appData.groups[newGroupIndex].id;
                    saveData(); // Save active group
                    renderHeader(); // Update header (for group specific buttons)
                    renderTabs();
                    renderMain();
                }
            }
    
            // ãƒªã‚»ãƒƒãƒˆ
            touchStartX = 0;
            touchEndX = 0;
        });
        */

        // --- Boot ---
        document.addEventListener('DOMContentLoaded', init); // Use DOMContentLoaded for initial setup
    </script>
</body>

</html>